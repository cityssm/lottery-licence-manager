<div class="panel">
  <div class="panel-heading">
    <div class="level">
      <div class="level-left">
        <h2 class="has-text-weight-bold">Amendments</h2>
      </div>
      <div class="level-right has-text-weight-normal has-text-right is-hidden-print">
        <a class="button is-small has-tooltip-left" data-tooltip="Export Amendments" href="/reports/amendments-byLicence?licenceID=<%= licence.licenceID %>" download>
          <i class="fas fa-file-download" aria-hidden="true"></i>
          <span class="sr-only">Export</span>
        </a>
      </div>
    </div>
  </div>
  <%
    const amendmentDisplayLimit = configFns.getProperty("amendments.displayCount");

    for (let amendmentIndex = licence.licenceAmendments.length - 1; amendmentIndex >= Math.max(0, licence.licenceAmendments.length - amendmentDisplayLimit); amendmentIndex -= 1) {
      const amendmentObj = licence.licenceAmendments[amendmentIndex];
  %>
  <div class="panel-block is-block is-size-7">
    <p>
      <strong><%= amendmentObj.amendmentType %></strong><br />
      <span class="has-newline-chars"><%= amendmentObj.amendment %></span>
    </p>
    <p class="has-text-right is-italic">
      <%= amendmentObj.amendmentDateString %> <%= amendmentObj.amendmentTimeString %>
    </p>
  </div>
  <%
    }

    if (licence.licenceAmendments.length > amendmentDisplayLimit) {
      const amendmentHiddenCount = licence.licenceAmendments.length - amendmentDisplayLimit;
  %>
    <div class="panel-block is-block">
      <div class="message is-small is-warning">
        <p class="message-body">
          <strong>
            <%= amendmentHiddenCount %> more
            <%= (amendmentHiddenCount === 1 ? "amendment" : "amendments") %>
            not shown.
          </strong><br />
          <a class="is-hidden-print" href="/reports/amendments-byLicence?licenceID=<%= licence.licenceID %>" download>Export the full list.</a>
        </p>
      </div>
    </div>
  <%
    }
  %>
</div>
