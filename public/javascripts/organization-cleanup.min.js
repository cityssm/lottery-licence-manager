"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=document.getElementsByTagName("main")[0].getAttribute("data-url-prefix"),t="true"===document.getElementsByTagName("main")[0].getAttribute("data-can-update"),a=document.getElementById("filter--inactiveYears"),n=document.getElementById("container--searchResults"),s=t=>{const a=t.currentTarget,n=a.getAttribute("data-organization-name");cityssm.confirmModal("Delete Organization?","Are you sure you want delete "+cityssm.escapeHTML(n)+"?","Yes, Delete","danger",()=>{const t=a.getAttribute("data-organization-id");cityssm.postJSON(e+"/organizations/doDelete",{organizationID:t},e=>{e.success?(cityssm.alertModal(e.message,"","OK","success"),a.closest("tr").remove()):cityssm.alertModal(e.message,"","OK","danger")})})},i=()=>{n.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading organizations...</em></p>',cityssm.postJSON(e+"/organizations/doGetInactive",{inactiveYears:a.value},a=>{if(0===a.length)return void(n.innerHTML='<div class="message is-info"><p class="message-body">There are no inactive organizations to report.</p></div>');const i=document.createElement("table");i.className="table is-fullwidth is-striped is-hoverable",i.innerHTML='<thead><tr><th>Organization</th><th class="has-text-centered">Last Licence End Date</th><th class="has-text-centered">Created</th><th class="has-text-centered">Last Updated</th>'+(t?'<th><span class="sr-only">Delete</span></th>':"")+"</tr></thead>";const r=document.createElement("tbody");for(const n of a){const a=document.createElement("tr"),i=cityssm.escapeHTML(n.organizationName);a.innerHTML='<td><a data-tooltip="View Organization" href="'+e+"/organizations/"+n.organizationID.toString()+'">'+i+'</a></td><td class="has-text-centered">'+(n.licences_endDateMax?n.licences_endDateMaxString:'<span class="tag is-light is-danger">No Licences</span>')+'</td><td class="has-text-centered"><span data-tooltip="Created by '+n.recordCreate_userName+'">'+n.recordCreate_dateString+'</span></td><td class="has-text-centered"><span data-tooltip="Updated by '+n.recordUpdate_userName+'">'+n.recordUpdate_dateString+"</span></td>",t&&(a.insertAdjacentHTML("beforeend",'<td class="has-text-right"><button class="button is-small is-danger" data-tooltip="Delete Organization" data-organization-id="'+n.organizationID.toString()+'" data-organization-name="'+i+'" type="button"><span class="icon"><i class="fas fa-trash" aria-hidden="true"></i></span> <span>Delete</span></button></td>'),a.getElementsByTagName("button")[0].addEventListener("click",s)),r.appendChild(a)}i.appendChild(r),cityssm.clearElement(n),n.appendChild(i)})};a.addEventListener("change",i),i()})();