(function(){function l(a){var c=a.currentTarget;a=cityssm.escapeHTML(c.getAttribute("data-organization-name"));cityssm.confirmModal("Delete Organization?","Are you sure you want delete "+a+"?","Yes, Delete","danger",function(){var a=c.getAttribute("data-organization-id");cityssm.postJSON("/organizations/doDelete",{organizationID:a},function(a){a.success?(cityssm.alertModal(a.message,"","OK","success"),c.closest("tr").remove()):cityssm.alertModal(a.message,"","OK","danger")})})}function d(){f.innerHTML=
'<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading organizations...</em></p>';cityssm.postJSON("/organizations/doGetInactive",{inactiveYears:e.value},function(a){if(0===a.length)f.innerHTML='<div class="message is-info"><p class="message-body">There are no inactive organizations to report.</p></div>';else{var c=document.createElement("table");c.className="table is-fullwidth is-striped is-hoverable";c.innerHTML=
'<thead><tr><th>Organization</th><th class="has-text-centered">Last Licence End Date</th><th class="has-text-centered">Created</th><th class="has-text-centered">Last Updated</th>'+(k?'<th><span class="sr-only">Delete</span></th>':"")+"</tr></thead>";for(var d=document.createElement("tbody"),h=0;h<a.length;h+=1){var b=a[h],g=document.createElement("tr"),e=cityssm.escapeHTML(b.organizationName);g.innerHTML='<td><a data-tooltip="View Organization" href="/organizations/'+b.organizationID+'">'+e+"</a></td>"+
('<td class="has-text-centered">'+(b.licences_endDateMax?b.licences_endDateMaxString:'<span class="tag is-light is-danger">No Licences</span>')+"</td>")+('<td class="has-text-centered"><span data-tooltip="Created by '+b.recordCreate_userName+'">'+b.recordCreate_dateString+"</span></td>")+('<td class="has-text-centered"><span data-tooltip="Updated by '+b.recordUpdate_userName+'">'+b.recordUpdate_dateString+"</span></td>");k&&(g.insertAdjacentHTML("beforeend",'<td class="has-text-right"><button class="button is-small is-danger" data-tooltip="Delete Organization" data-organization-id="'+
b.organizationID+'" data-organization-name="'+e+'" type="button"><span class="icon"><i class="fas fa-trash" aria-hidden="true"></i></span> <span>Delete</span></button></td>'),g.getElementsByTagName("button")[0].addEventListener("click",l));d.appendChild(g)}c.appendChild(d);cityssm.clearElement(f);f.appendChild(c)}})}var k="true"===document.getElementsByTagName("main")[0].getAttribute("data-can-update"),e=document.getElementById("filter--inactiveYears"),f=document.getElementById("container--searchResults");
e.addEventListener("change",d);d()})();
