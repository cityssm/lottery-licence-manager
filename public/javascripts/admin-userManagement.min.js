"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=document.querySelector("main").dataset.urlPrefix,t=document.querySelector("#is-create-user-modal");t.querySelectorAll("form")[0].addEventListener("submit",t=>{t.preventDefault(),cityssm.postJSON(e+"/admin/doCreateUser",t.currentTarget,e=>{e.success&&window.location.reload()})}),document.querySelector("#is-create-user-button").addEventListener("click",()=>{cityssm.showModal(t)});let s=t.querySelectorAll(".is-cancel-button");for(const e of s)e.addEventListener("click",cityssm.hideModal);const r=document.querySelector("#container--users"),o=t=>{t.preventDefault();const s=t.currentTarget,r=s.getAttribute("data-user-name"),o=s.closest("tr");cityssm.confirmModal("Delete User?","Are you sure you want to delete <em>"+cityssm.escapeHTML(r)+"</em>?<br />","Yes, Delete","warning",()=>{cityssm.postJSON(e+"/admin/doDeleteUser",{userName:r},e=>{e.success&&o.remove()})})},a=r.querySelectorAll(".is-delete-user-button");for(const e of a)e.addEventListener("click",o);const c=document.querySelector("#is-update-user-modal"),n=c.querySelectorAll(".container--userName"),i=t=>{t.preventDefault();const s=t.currentTarget;cityssm.postJSON(e+"/admin/doUpdateUserProperty",s,e=>{if(e.success){const e=s.querySelector(".input");e.classList.add("is-success"),e.classList.remove("is-danger");const t=s.querySelector("button");t.classList.add("is-success"),t.classList.remove("is-danger")}})},u=e=>{const t=e.currentTarget;t.classList.add("is-danger"),t.classList.remove("is-primary"),t.classList.remove("is-success");const s=t.closest(".field").querySelector("button");s.classList.add("is-danger"),s.classList.remove("is-primary"),s.classList.remove("is-success")},d=t=>{t.preventDefault();const s=t.currentTarget,r=s.getAttribute("data-user-name"),o=s.getAttribute("data-first-name"),a=s.getAttribute("data-last-name");for(const e of n)e.textContent=r;document.querySelector("#updateUser--userName").value=r,document.querySelector("#updateUser--firstName").value=o,document.querySelector("#updateUser--lastName").value=a;const d=document.querySelector("#container--userProperties");cityssm.clearElement(d),cityssm.postJSON(e+"/admin/doGetUserProperties",{userName:r},e=>{let t=0;for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){t+=1;const o=e[s],a=document.createElement("form");a.innerHTML='<input name="userName" type="hidden" value="'+r+'" /><input name="propertyName" type="hidden" value="'+s+'" /><div class="columns"><div class="column is-4"><label class="label" for="userProperties--propertyValue-'+t.toString()+'">'+s+'</label></div><div class="column"><div class="field has-addons"><div class="control is-expanded"><input class="input is-primary" id="userProperties--propertyValue-'+t.toString()+'" name="propertyValue" type="text" value="'+cityssm.escapeHTML(o)+'" placeholder="(Use Default)" /></div><div class="control"><button class="button is-outlined is-primary" type="submit">Save</button></div></div></div></div>',a.querySelector(".input").addEventListener("keyup",u),a.addEventListener("submit",i),d.append(a)}}),document.querySelector("#resetPassword--userName").value=r,document.querySelector("#resetPassword--newPassword").closest(".message").setAttribute("hidden","hidden"),cityssm.showModal(c)},l=r.querySelectorAll(".is-update-user-button");for(const e of l)e.addEventListener("click",d);s=c.querySelectorAll(".is-cancel-button");for(const e of s)e.addEventListener("click",cityssm.hideModal);document.querySelector("#tab--updateUser-name").querySelector("form").addEventListener("submit",t=>{t.preventDefault(),cityssm.postJSON(e+"/admin/doUpdateUser",t.currentTarget,e=>{e.success&&window.location.reload()})}),document.querySelector("#tab--updateUser-password").querySelector("form").addEventListener("submit",t=>{t.preventDefault(),cityssm.postJSON(e+"/admin/doResetPassword",t.currentTarget,e=>{if(e.success){const t=document.querySelector("#resetPassword--newPassword");t.textContent=e.newPassword,t.closest(".message").removeAttribute("hidden")}})})})();