"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=null===(e=document.querySelector("main"))||void 0===e?void 0:e.dataset.urlPrefix,n=document.querySelector("#form--filters"),a=document.querySelector("#filter--limit"),s=document.querySelector("#filter--offset"),i=document.querySelector("#container--events");function c(){s.value="0",function e(){const c=Number.parseInt(a.value,10),r=Number.parseInt(s.value,10);i.innerHTML='<p class="has-text-centered has-text-grey-lighter">\n        <i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br />\n        <em>Loading events...</em>\n      </p>',cityssm.postJSON(`${t}/events/doSearch`,n,n=>{var a,l,o;const d=n,p=d.events;if(0===p.length)return void(i.innerHTML='<div class="message is-info">\n              <div class="message-body">Your search returned no results.</div>\n            </div>');const u=document.createElement("tbody");for(const e of p){const n=null!==(a=exports.config_licenceTypes[e.licenceTypeKey])&&void 0!==a?a:e.licenceTypeKey,s=`${t}/events/${e.licenceID.toString()}/${e.eventDate.toString()}`,i=document.createElement("tr");i.innerHTML=`<td>\n              <a href="${cityssm.escapeHTML(s)}">${e.eventDateString}</a>\n              </td>\n              <td>\n                ${cityssm.escapeHTML(e.externalLicenceNumber)}<br />\n                <small>Licence #${e.licenceID.toString()}</small>\n              </td>\n              <td>\n                ${cityssm.escapeHTML(null!==(l=e.organizationName)&&void 0!==l?l:"")}\n              </td>\n              <td>\n                ${n}<br />\n                <small>${cityssm.escapeHTML(e.licenceDetails)}</small>\n              </td>\n              <td>\n                ${e.locationDisplayName?cityssm.escapeHTML(e.locationDisplayName):'<span class="has-text-grey">(No Location)</span>'}<br />\n                <small>\n                  ${e.startTimeString}${e.startTimeString===e.endTimeString?"":" to "+e.endTimeString}\n                </small>\n              </td>\n              <td class="is-hidden-print has-text-right">\n                ${e.canUpdate?`<a class="button is-small" href="${cityssm.escapeHTML(s)}/edit">\n                        <span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span>\n                        <span>Edit</span>\n                        </a>`:""}\n              </td>`,u.append(i)}cityssm.clearElement(i);const m=document.createElement("table");if(m.className="table is-fullwidth is-striped is-hoverable has-sticky-header",m.innerHTML='<thead>\n            <tr>\n              <th>Event Date</th>\n              <th>Licence</th>\n              <th>Organization</th>\n              <th>Licence Type</th>\n              <th>Location</th>\n              <th><span class="is-sr-only">Options</span></th>\n            </tr>\n            </thead>',m.append(u),i.append(m),i.insertAdjacentHTML("beforeend",`<div class="level is-block-print">\n            <div class="level-left has-text-weight-bold">\n              Displaying events ${(r+1).toString()}\n              to ${Math.min(c+r,d.count).toString()}\n              of ${d.count.toString()}\n            </div>\n            </div>`),c<d.count){const t=document.createElement("nav");if(t.className="level-right is-hidden-print",t.setAttribute("role","pagination"),t.setAttribute("aria-label","pagination"),r>0){const n=document.createElement("a");n.className="button",n.textContent="Previous",n.addEventListener("click",t=>{t.preventDefault(),s.value=Math.max(0,r-c).toString(),e()}),t.append(n)}if(c+r<d.count){const n=document.createElement("a");n.className="button ml-3",n.innerHTML='<span>Next Events</span>\n              <span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',n.addEventListener("click",t=>{t.preventDefault(),s.value=(r+c).toString(),e()}),t.append(n)}null===(o=i.querySelector(".level"))||void 0===o||o.append(t)}})}()}n.addEventListener("submit",e=>{e.preventDefault()});const r=n.querySelectorAll(".input, .select select");for(const e of r)e.addEventListener("change",c);c()})();