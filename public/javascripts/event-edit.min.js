"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=document.getElementById("eventNav--eventDate"),t=document.getElementById("form--event"),n=document.getElementById("container--form-message"),s=document.getElementById("event--licenceID").value,a=document.getElementById("event--eventDate").value;t.addEventListener("submit",s=>{s.preventDefault(),n.innerHTML='Saving... <i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i>',cityssm.postJSON("/events/doSave",t,t=>{t.success&&(cityssm.disableNavBlocker(),e&&e.removeAttribute("disabled")),n.innerHTML="",cityssm.alertModal(t.message,"","OK",t.success?"success":"danger")})}),document.getElementById("is-delete-event-button").addEventListener("click",e=>{e.preventDefault(),cityssm.confirmModal("Delete Event?","Are you sure you want to delete this event?","Yes, Delete","danger",()=>{cityssm.postJSON("/events/doDelete",{licenceID:s,eventDate:a},e=>{e.success&&(cityssm.disableNavBlocker(),window.location.href="/licences/"+s)})})});const c=()=>{cityssm.enableNavBlocker(),e&&e.setAttribute("disabled","disabled"),n.innerHTML='<span class="tag is-light is-info is-medium"><span class="icon"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i></span> <span>Unsaved Changes</span></div>'},d=t.querySelectorAll("input, select, textarea");for(const e of d)""!==e.name&&e.addEventListener("change",c);document.getElementById("is-bank-information-lookup-button").addEventListener("click",e=>{let t,n;e.preventDefault();const a=e=>{e.preventDefault();const s=parseInt(e.currentTarget.getAttribute("data-list-index"),10),a=n[s];document.getElementById("event--bank_name").value=a.bank_name,document.getElementById("event--bank_address").value=a.bank_address,document.getElementById("event--bank_accountNumber").value=a.bank_accountNumber,c(),t()};cityssm.openHtmlModal("event-bankInformationLookup",{onshow:()=>{const e=document.getElementById("container--bankInformationLookup");cityssm.postJSON("/events/doGetPastBankInformation",{licenceID:s},t=>{n=t;const s=document.createElement("div");s.className="panel mb-3",n.forEach((e,t)=>{const n=document.createElement("a");n.className="panel-block is-block",n.setAttribute("data-list-index",t.toString()),n.innerHTML=`<div class="columns">\n            <div class="column">${cityssm.escapeHTML(e.bank_name)}</div>\n            <div class="column">${cityssm.escapeHTML(e.bank_address)}</div>\n            <div class="column">${cityssm.escapeHTML(e.bank_accountNumber)}</div>\n            </div>\n            <div class="has-text-right">\n            <span class="tag is-info" data-tooltip="Last Used Event Date">\n            ${e.eventDateMaxString}\n            </span>\n            </div>`,n.addEventListener("click",a),s.insertAdjacentElement("beforeend",n)}),cityssm.clearElement(e),e.insertAdjacentElement("beforeend",s)})},onshown(e,n){t=n}})});const o=document.getElementById("event--costs_receipts"),i=document.getElementById("event--costs_admin"),l=document.getElementById("event--costs_prizesAwarded"),m=document.getElementById("event--costs_netProceeds"),r=document.getElementById("event--costs_amountDonated"),u=()=>{const e=(parseFloat(o.value||"0")-parseFloat(i.value||"0")-parseFloat(l.value||"0")).toFixed(2);m.value=e,r.setAttribute("max",e)};o.addEventListener("keyup",u),i.addEventListener("keyup",u),l.addEventListener("keyup",u)})();