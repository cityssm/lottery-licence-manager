(function(){function n(){cityssm.enableNavBlocker();p.setAttribute("disabled","disabled");e.innerHTML='<span class="tag is-light is-info is-medium"><span class="icon"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i></span> <span>Unsaved Changes</span></div>'}var p=document.getElementById("eventNav--eventDate"),k=document.getElementById("form--event"),e=document.getElementById("container--form-message"),l=document.getElementById("event--licenceID").value,q=document.getElementById("event--eventDate").value;
k.addEventListener("submit",function(c){c.preventDefault();e.innerHTML='Saving... <i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i>';cityssm.postJSON("/events/doSave",k,function(a){a.success&&(cityssm.disableNavBlocker(),p.removeAttribute("disabled"));e.innerHTML="";cityssm.alertModal(a.message,"","OK",a.success?"success":"danger")})});document.getElementById("is-delete-event-button").addEventListener("click",function(c){c.preventDefault();cityssm.confirmModal("Delete Event?","Are you sure you want to delete this event?",
"Yes, Delete","danger",function(){cityssm.postJSON("/events/doDelete",{licenceID:l,eventDate:q},function(a){a.success&&(cityssm.disableNavBlocker(),window.location.href="/licences/"+l)})})});for(var m=k.querySelectorAll("input, select, textarea"),d=0;d<m.length;d+=1)""!==m[d].name&&m[d].addEventListener("change",n);document.getElementById("is-bank-information-lookup-button").addEventListener("click",function(c){c.preventDefault();var a,d,e=function(b){b.preventDefault();b=parseInt(b.currentTarget.getAttribute("data-list-index"));
b=d[b];document.getElementById("event--bank_name").value=b.bank_name;document.getElementById("event--bank_address").value=b.bank_address;document.getElementById("event--bank_accountNumber").value=b.bank_accountNumber;n();a()};cityssm.openHtmlModal("event-bankInformationLookup",{onshow:function(){var b=document.getElementById("container--bankInformationLookup");cityssm.postJSON("/events/doGetPastBankInformation",{licenceID:l},function(a){d=a;var c=document.createElement("div");c.className="list is-hoverable has-margin-bottom-10";
for(var g=0;g<a.length;g+=1){var h=a[g],f=document.createElement("a");f.className="list-item";f.setAttribute("data-list-index",g);f.innerHTML='<div class="columns"><div class="column">'+cityssm.escapeHTML(h.bank_name)+'</div><div class="column">'+cityssm.escapeHTML(h.bank_address)+'</div><div class="column">'+cityssm.escapeHTML(h.bank_accountNumber)+'</div></div><div class="has-text-right"><span class="tag is-info" data-tooltip="Last Used Event Date">'+h.eventDateMaxString+"</span></div>";f.addEventListener("click",
e);c.insertAdjacentElement("beforeend",f)}cityssm.clearElement(b);b.insertAdjacentElement("beforeend",c)})},onshown:function(b,c){a=c}})})})();
