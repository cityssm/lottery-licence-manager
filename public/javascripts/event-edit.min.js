(function(){function n(){cityssm.enableNavBlocker();b&&b.setAttribute("disabled","disabled");e.innerHTML='<span class="tag is-light is-info is-medium"><span class="icon"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i></span> <span>Unsaved Changes</span></div>'}function c(){var a=((p.value||0)-(q.value||0)-(r.value||0)).toFixed(2);t.value=a;u.setAttribute("max",a)}var b=document.getElementById("eventNav--eventDate"),k=document.getElementById("form--event"),e=document.getElementById("container--form-message"),
l=document.getElementById("event--licenceID").value,v=document.getElementById("event--eventDate").value;k.addEventListener("submit",function(a){a.preventDefault();e.innerHTML='Saving... <i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i>';cityssm.postJSON("/events/doSave",k,function(a){a.success&&(cityssm.disableNavBlocker(),b&&b.removeAttribute("disabled"));e.innerHTML="";cityssm.alertModal(a.message,"","OK",a.success?"success":"danger")})});document.getElementById("is-delete-event-button").addEventListener("click",
function(a){a.preventDefault();cityssm.confirmModal("Delete Event?","Are you sure you want to delete this event?","Yes, Delete","danger",function(){cityssm.postJSON("/events/doDelete",{licenceID:l,eventDate:v},function(a){a.success&&(cityssm.disableNavBlocker(),window.location.href="/licences/"+l)})})});for(var m=k.querySelectorAll("input, select, textarea"),d=0;d<m.length;d+=1)""!==m[d].name&&m[d].addEventListener("change",n);document.getElementById("is-bank-information-lookup-button").addEventListener("click",
function(a){a.preventDefault();var b,d,e=function(a){a.preventDefault();a=parseInt(a.currentTarget.getAttribute("data-list-index"));a=d[a];document.getElementById("event--bank_name").value=a.bank_name;document.getElementById("event--bank_address").value=a.bank_address;document.getElementById("event--bank_accountNumber").value=a.bank_accountNumber;n();b()};cityssm.openHtmlModal("event-bankInformationLookup",{onshow:function(){var a=document.getElementById("container--bankInformationLookup");cityssm.postJSON("/events/doGetPastBankInformation",
{licenceID:l},function(b){d=b;var c=document.createElement("div");c.className="list is-hoverable has-margin-bottom-10";for(var g=0;g<b.length;g+=1){var h=b[g],f=document.createElement("a");f.className="list-item";f.setAttribute("data-list-index",g);f.innerHTML='<div class="columns"><div class="column">'+cityssm.escapeHTML(h.bank_name)+'</div><div class="column">'+cityssm.escapeHTML(h.bank_address)+'</div><div class="column">'+cityssm.escapeHTML(h.bank_accountNumber)+'</div></div><div class="has-text-right"><span class="tag is-info" data-tooltip="Last Used Event Date">'+
h.eventDateMaxString+"</span></div>";f.addEventListener("click",e);c.insertAdjacentElement("beforeend",f)}cityssm.clearElement(a);a.insertAdjacentElement("beforeend",c)})},onshown:function(a,c){b=c}})});var p=document.getElementById("event--costs_receipts"),q=document.getElementById("event--costs_admin"),r=document.getElementById("event--costs_prizesAwarded"),t=document.getElementById("event--costs_netProceeds"),u=document.getElementById("event--costs_amountDonated");p.addEventListener("keyup",c);
q.addEventListener("keyup",c);r.addEventListener("keyup",c)})();
