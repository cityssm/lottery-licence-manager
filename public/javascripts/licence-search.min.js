(function(){function g(){e.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading licences...</p>';window.fetch("/licences/doSearch",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(c))}).then(function(a){return a.json()}).then(function(a){if(0===a.length)e.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>';
else{e.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>'+k+'</th><th>Organization Name</th><th>Licence</th><th>Dates</th><th><span class="sr-only">Options</span></th></tr></thead><tbody></tbody></table>';for(var d=e.getElementsByTagName("tbody")[0],c=0;c<a.length;c+=1){var b=a[c],g=h[b.licenceTypeKey],f=document.createElement("tr");f.innerHTML='<td><a href="/licences/'+b.licenceID+'">'+window.llm.escapeHTML(b.externalLicenceNumber)+"<br /><small>Licence #"+b.licenceID+
"</small></a></td><td>"+window.llm.escapeHTML(b.organizationName)+"</td><td>"+(g||b.licenceTypeKey)+"<br /><small>"+window.llm.escapeHTML(b.licenceDetails)+"</small></td>"+('<td><span class="has-tooltip-right" data-tooltip="Start Date"><i class="fas fa-fw fa-play" aria-hidden="true"></i> '+b.startDateString+'</span><br /><span class="has-tooltip-right" data-tooltip="End Date"><i class="fas fa-fw fa-stop" aria-hidden="true"></i> '+b.endDateString+"</span></td>")+'<td class="has-text-right">'+(b.canUpdate?
'<a class="button is-small" data-tooltip="Edit Licence" href="/licences/'+b.licenceID+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></a> ':"")+(b.licenceFeeIsPaid?'<a class="button is-small" data-tooltip="Print Licence" href="/licences/'+b.licenceID+'/print" target="_blank"><i class="fas fa-print" aria-hidden="true"></i><span class="sr-only">Print</span></a>':'<span class="tag is-warning">Unpaid</span>')+"</div></td>";d.insertAdjacentElement("beforeend",
f)}}})}for(var h={},c=document.getElementById("form--filters"),e=document.getElementById("container--searchResults"),k=e.getAttribute("data-external-licence-number-label"),d=document.getElementById("filter--licenceTypeKey").getElementsByTagName("option"),a=1;a<d.length;a+=1){var f=d[a];h[f.value]=f.innerText}c.addEventListener("submit",function(a){a.preventDefault()});d=c.querySelectorAll(".input, .select select");for(a=0;a<d.length;a+=1)d[a].addEventListener("change",g);g()})();
