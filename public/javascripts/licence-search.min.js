(function(){function n(){var b=parseInt(r.value),g=parseInt(m.value);f.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading licences...</em></p>';llm.postJSON("/licences/doSearch",k,function(c){var d=c.licences;if(0===d.length)f.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>';
else{f.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>'+t+'</th><th>Licence</th><th>Organization Name</th><th>Location</th><th>Active Date Range</th><th class="is-hidden-print"><span class="sr-only">Options</span></th></tr></thead><tbody></tbody></table>';for(var h=f.getElementsByTagName("tbody")[0],e=0;e<d.length;e+=1){var a=d[e],k=p[a.licenceTypeKey],l=document.createElement("tr");l.innerHTML='<td><a data-tooltip="View Licence" href="/licences/'+a.licenceID+
'">'+llm.escapeHTML(a.externalLicenceNumber)+"<br /><small>Licence #"+a.licenceID+"</small></a></td><td>"+(k||a.licenceTypeKey)+"<br /><small>"+llm.escapeHTML(a.licenceDetails)+"</small></td>"+('<td><a data-tooltip="View Organization" href="/organizations/'+a.organizationID+'">'+llm.escapeHTML(a.organizationName)+"</a></td>")+('<td><a data-tooltip="View Location" href="/locations/'+a.locationID+'">'+llm.escapeHTML(a.locationDisplayName)+"</a>"+(a.locationDisplayName===a.locationAddress1?"":"<br /><small>"+
llm.escapeHTML(a.locationAddress1)+"</small>")+"</td>")+('<td class="is-nowrap"><span class="has-cursor-default has-tooltip-right" data-tooltip="Start Date"><i class="fas fa-fw fa-play" aria-hidden="true"></i> '+a.startDateString+'</span><br /><span class="has-cursor-default has-tooltip-right" data-tooltip="End Date"><i class="fas fa-fw fa-stop" aria-hidden="true"></i> '+a.endDateString+"</span></td>")+'<td class="has-text-right is-nowrap is-hidden-print">'+(a.canUpdate?'<a class="button is-small" data-tooltip="Edit Licence" href="/licences/'+
a.licenceID+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></a> ':"")+(a.issueDate?'<a class="button is-small" data-tooltip="Print Licence" href="/licences/'+a.licenceID+'/print" download><i class="fas fa-print" aria-hidden="true"></i><span class="sr-only">Print</span></a>':'<span class="tag is-warning">Not Issued</span>')+"</div></td>";h.insertAdjacentElement("beforeend",l)}f.insertAdjacentHTML("beforeend",'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying licences '+
(g+1)+" to "+Math.min(b+g,c.count)+" of "+c.count+"</div></div>");b<c.count&&(d=document.createElement("nav"),d.className="level-right is-hidden-print",d.setAttribute("role","pagination"),d.setAttribute("aria-label","pagination"),0<g&&(h=document.createElement("a"),h.className="button",h.innerText="Previous",h.addEventListener("click",function(a){a.preventDefault();m.value=Math.max(0,g-b);n()}),d.insertAdjacentElement("beforeend",h)),b+g<c.count&&(c=document.createElement("a"),c.className="button has-margin-left-10",
c.innerHTML='<span>Next Licences</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',c.addEventListener("click",function(a){a.preventDefault();m.value=g+b;n()}),d.insertAdjacentElement("beforeend",c)),f.getElementsByClassName("level")[0].insertAdjacentElement("beforeend",d))}})}function l(){m.value=0;n()}for(var p={},k=document.getElementById("form--filters"),r=document.getElementById("filter--limit"),m=document.getElementById("filter--offset"),f=document.getElementById("container--searchResults"),
t=f.getAttribute("data-external-licence-number-label"),e=document.getElementById("filter--licenceTypeKey").getElementsByTagName("option"),b=1;b<e.length;b+=1){var q=e[b];p[q.value]=q.innerText}k.addEventListener("submit",function(b){b.preventDefault()});e=k.querySelectorAll(".input, .select select");for(b=0;b<e.length;b+=1)e[b].addEventListener("change",l);l()})();
