"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=new Map,t=document.getElementById("form--filters"),a=document.getElementById("filter--limit"),n=document.getElementById("filter--offset"),s=document.getElementById("container--searchResults"),i=s.getAttribute("data-external-licence-number-label"),c=()=>{const l=parseInt(a.value,10),r=parseInt(n.value,10);s.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading licences...</em></p>',cityssm.postJSON("/licences/doSearch",t,t=>{const a=t.licences;if(0===a.length)return void(s.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>');s.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>'+cityssm.escapeHTML(i)+'</th><th>Licence</th><th>Organization Name</th><th>Location</th><th>Active Date Range</th><th class="is-hidden-print"><span class="sr-only">Options</span></th></tr></thead><tbody></tbody></table>';const o=s.getElementsByTagName("tbody")[0];for(const t of a){const a=e.get(t.licenceTypeKey),n=document.createElement("tr");n.innerHTML='<td><a data-tooltip="View Licence" href="/licences/'+t.licenceID.toString()+'">'+cityssm.escapeHTML(t.externalLicenceNumber)+"<br /><small>Licence #"+t.licenceID.toString()+"</small></a></td><td>"+cityssm.escapeHTML(a||t.licenceTypeKey)+"<br /><small>"+cityssm.escapeHTML(t.licenceDetails)+"</small></td>"+`<td>\n              <a data-tooltip="View Organization"\n                href="/organizations/${t.organizationID.toString()}">\n              ${cityssm.escapeHTML(t.organizationName)}\n              </a>\n              </td>`+'<td><a data-tooltip="View Location" href="/locations/'+t.locationID.toString()+'">'+cityssm.escapeHTML(t.locationDisplayName)+"</a>"+(t.locationDisplayName===t.locationAddress1?"":`<br /><small>${cityssm.escapeHTML(t.locationAddress1)}</small>`)+'</td><td class="is-nowrap"><span class="has-cursor-default has-tooltip-right" data-tooltip="Start Date"><i class="fas fa-fw fa-play" aria-hidden="true"></i> '+t.startDateString+'</span><br /><span class="has-cursor-default has-tooltip-right" data-tooltip="End Date"><i class="fas fa-fw fa-stop" aria-hidden="true"></i> '+t.endDateString+'</span></td><td class="has-text-right is-nowrap is-hidden-print">'+(t.canUpdate?'<a class="button is-small" data-tooltip="Edit Licence" href="/licences/'+t.licenceID.toString()+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></a> ':"")+(t.issueDate?'<a class="button is-small" data-tooltip="Print Licence" href="/licences/'+t.licenceID.toString()+'/print" download><i class="fas fa-print" aria-hidden="true"></i><span class="sr-only">Print</span></a>':'<span class="tag is-warning">Not Issued</span>')+"</div></td>",o.insertAdjacentElement("beforeend",n)}if(s.insertAdjacentHTML("beforeend",'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying licences '+(r+1).toString()+" to "+Math.min(l+r,t.count).toString()+" of "+t.count.toString()+"</div></div>"),l<t.count){const e=document.createElement("nav");if(e.className="level-right is-hidden-print",e.setAttribute("role","pagination"),e.setAttribute("aria-label","pagination"),r>0){const t=document.createElement("a");t.className="button",t.innerText="Previous",t.addEventListener("click",e=>{e.preventDefault(),n.value=Math.max(0,r-l).toString(),c()}),e.insertAdjacentElement("beforeend",t)}if(l+r<t.count){const t=document.createElement("a");t.className="button ml-3",t.innerHTML='<span>Next Licences</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',t.addEventListener("click",e=>{e.preventDefault(),n.value=(r+l).toString(),c()}),e.insertAdjacentElement("beforeend",t)}s.getElementsByClassName("level")[0].insertAdjacentElement("beforeend",e)}})},l=()=>{n.value="0",c()},r=document.getElementById("filter--licenceTypeKey").getElementsByTagName("option");for(let t=1;t<r.length;t+=1){const a=r[t];e.set(a.value,a.innerText)}t.addEventListener("submit",e=>{e.preventDefault()});const o=t.querySelectorAll(".input, .select select");for(const e of o)e.addEventListener("change",l);l()})();