"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=document.getElementById("form--searchFilters"),t=document.getElementById("filter--limit"),a=document.getElementById("filter--offset"),n=document.getElementById("container--searchResults"),s="true"===document.getElementsByTagName("main")[0].getAttribute("data-can-create"),i=[];function r(e,t){var a=document.createElement("tr");a.innerHTML="<td></td>";var n=document.createElement("a");n.innerText=e.locationDisplayName,n.href="/locations/"+e.locationID,a.getElementsByTagName("td")[0].insertAdjacentElement("beforeend",n);var i=document.createElement("td");if(i.innerHTML=(""===e.locationAddress1?"":cityssm.escapeHTML(e.locationAddress1)+"<br />")+(""===e.locationAddress2?"":"<small>"+cityssm.escapeHTML(e.locationAddress2)+"</small><br />")+(""===e.locationCity?"":"<small>"+cityssm.escapeHTML(e.locationCity)+", "+e.locationProvince+"</small>"),a.insertAdjacentElement("beforeend",i),a.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(""===e.licences_endDateMaxString?'<span class="has-text-grey">Not Used</span>':e.licences_endDateMaxString)+"</td>"),a.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(e.locationIsManufacturer?'<span data-tooltip="Manufacturer"><span class="tag is-success">Yes</span><br />'+(""===e.manufacturer_endDateMaxString?'<span class="has-text-grey">Never Used</span>':e.manufacturer_endDateMaxString)+"</span>":'<span class="sr-only">No</span>')+"</td>"),a.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(e.locationIsDistributor?'<span data-tooltip="Distributor"><span class="tag is-success">Yes</span><br />'+(""===e.distributor_endDateMaxString?'<span class="has-text-grey">Never Used</span>':e.distributor_endDateMaxString)+"</span>":'<span class="sr-only">No</span>')+"</td>"),s){var r=e.canUpdate&&0===e.licences_count&&0===e.distributor_count&&0===e.manufacturer_count;a.insertAdjacentHTML("beforeend",'<td class="is-hidden-print has-text-right is-nowrap">'+(e.canUpdate?'<a class="button is-small" data-tooltip="Edit Location" href="/locations/'+e.locationID+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span> <span>Edit</span></a>':"")+(r?' <button class="button is-small is-danger is-delete-location-button" data-tooltip="Delete Location" data-location-index="'+t+'" type="button"><span class="icon"><i class="fas fa-trash" aria-hidden="true"></i></span></button>':"")+"</td>"),r&&a.getElementsByClassName("is-delete-location-button")[0].addEventListener("click",l)}return a}function c(){var o=parseInt(t.value),l=parseInt(a.value);i=[],n.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading locations...</em></p>',cityssm.postJSON("/locations/doGetLocations",e,function(e){if(0!==(i=e.locations).length){n.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>Location</th><th>Address</th><th class="has-text-centered">Last Licence End Date</th><th class="has-text-centered">Last Manufacturer End Date</th><th class="has-text-centered">Last Distributor End Date</th>'+(s?'<th class="is-hidden-print"><span class="sr-only">Options</span></th>':"")+"</tr></thead><tbody></tbody></table>";for(var t=n.getElementsByTagName("tbody")[0],d=0;d<i.length;d+=1){var u=r(i[d],d);t.insertAdjacentElement("beforeend",u)}if(n.insertAdjacentHTML("beforeend",'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying locations '+(l+1)+" to "+Math.min(o+l,e.count)+" of "+e.count+"</div></div>"),o<e.count){var m=document.createElement("nav");if(m.className="level-right is-hidden-print",m.setAttribute("role","pagination"),m.setAttribute("aria-label","pagination"),l>0){var p=document.createElement("a");p.className="button",p.innerText="Previous",p.addEventListener("click",function(e){e.preventDefault(),a.value=Math.max(0,l-o).toString(),c()}),m.insertAdjacentElement("beforeend",p)}if(o+l<e.count){var f=document.createElement("a");f.className="button ml-3",f.innerHTML='<span>Next Locations</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',f.addEventListener("click",function(e){e.preventDefault(),a.value=(l+o).toString(),c()}),m.insertAdjacentElement("beforeend",f)}n.getElementsByClassName("level")[0].insertAdjacentElement("beforeend",m)}}else n.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>'})}function o(){a.value="0",c()}function l(e){e.preventDefault();var t=parseInt(e.currentTarget.getAttribute("data-location-index")),a=i[t];cityssm.confirmModal("Delete Location","Are you sure you want to delete "+cityssm.escapeHTML(a.locationDisplayName)+"?","Yes, Delete","warning",function(){cityssm.postJSON("/locations/doDelete",{locationID:a.locationID},function(e){e.success&&c()})})}e.addEventListener("submit",function(e){e.preventDefault()}),document.getElementById("filter--locationNameAddress").addEventListener("change",o),document.getElementById("filter--locationIsDistributor").addEventListener("change",o),document.getElementById("filter--locationIsManufacturer").addEventListener("change",o),o()}();