(function(){function q(a,d){var b=document.createElement("tr");b.innerHTML="<td></td>";var c=document.createElement("a");c.innerText=a.locationDisplayName;c.href="/locations/"+a.locationID;b.getElementsByTagName("td")[0].insertAdjacentElement("beforeend",c);c=document.createElement("td");c.innerHTML=llm.escapeHTML(a.locationAddress1)+(""===a.locationAddress2?"":"<br /><small>"+llm.escapeHTML(a.locationAddress2)+"</small>")+(""===a.locationCity?"":"<br /><small>"+llm.escapeHTML(a.locationCity)+", "+
a.locationProvince+"</small>");b.insertAdjacentElement("beforeend",c);b.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(""===a.licences_endDateMaxString?'<span class="has-text-grey">Not Used</span>':a.licences_endDateMaxString)+"</td>");b.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(a.locationIsDistributor?'<span data-tooltip="Distributor"><span class="tag is-success">Yes</span><br />'+(""===a.distributor_endDateMaxString?'<span class="has-text-grey">Never Used</span>':
a.distributor_endDateMaxString)+"</span>":'<span class="sr-only">No</span>')+"</td>");b.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(a.locationIsManufacturer?'<span data-tooltip="Manufacturer"><span class="tag is-success">Yes</span><br />'+(""===a.manufacturer_endDateMaxString?'<span class="has-text-grey">Never Used</span>':a.manufacturer_endDateMaxString)+"</span>":'<span class="sr-only">No</span>')+"</td>");m&&(c=a.canUpdate&&0===a.licences_count&&0===a.distributor_count&&0===
a.manufacturer_count,b.insertAdjacentHTML("beforeend",'<td class="is-hidden-print has-text-right is-nowrap">'+(a.canUpdate?'<a class="button is-small" data-tooltip="Edit Location" href="/locations/'+a.locationID+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span> <span>Edit</span></a>':"")+(c?' <button class="button is-small is-danger is-delete-location-button" data-tooltip="Delete Location" data-location-index="'+d+'" type="button"><span class="icon"><i class="fas fa-trash" aria-hidden="true"></i></span></button>':
"")+"</td>"),c&&b.getElementsByClassName("is-delete-location-button")[0].addEventListener("click",n));return b}function k(){var a=parseInt(r.value),d=parseInt(l.value);f=[];g.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading locations...</em></p>';llm.postJSON("/locations/doGetLocations",p,function(b){f=b.locations;if(0===f.length)g.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>';
else{g.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>Location</th><th>Address</th><th class="has-text-centered">Licences</th><th class="has-text-centered">Distributor</th><th class="has-text-centered">Manufacturer</th>'+(m?'<th class="is-hidden-print"><span class="sr-only">Options</span></th>':"")+"</tr></thead><tbody></tbody></table>";for(var c=g.getElementsByTagName("tbody")[0],e=0;e<f.length;e+=1){var h=q(f[e],e);c.insertAdjacentElement("beforeend",h)}g.insertAdjacentHTML("beforeend",
'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying locations '+(d+1)+" to "+Math.min(a+d,b.count)+" of "+b.count+"</div></div>");a<b.count&&(c=document.createElement("nav"),c.className="level-right is-hidden-print",c.setAttribute("role","pagination"),c.setAttribute("aria-label","pagination"),0<d&&(e=document.createElement("a"),e.className="button",e.innerText="Previous",e.addEventListener("click",function(b){b.preventDefault();l.value=Math.max(0,d-a);k()}),
c.insertAdjacentElement("beforeend",e)),a+d<b.count&&(b=document.createElement("a"),b.className="button has-margin-left-10",b.innerHTML='<span>Next Locations</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',b.addEventListener("click",function(b){b.preventDefault();l.value=d+a;k()}),c.insertAdjacentElement("beforeend",b)),g.getElementsByClassName("level")[0].insertAdjacentElement("beforeend",c))}})}function h(){l.value=0;k()}var p=document.getElementById("form--searchFilters"),
r=document.getElementById("filter--limit"),l=document.getElementById("filter--offset"),g=document.getElementById("container--searchResults"),m="true"===document.getElementsByTagName("main")[0].getAttribute("data-can-create"),f=[],n;n=function(a){a.preventDefault();a=parseInt(a.currentTarget.getAttribute("data-location-index"));var d=f[a];llm.confirmModal("Delete Location","Are you sure you want to delete "+llm.escapeHTML(d.locationDisplayName)+"?","Yes, Delete","warning",function(){llm.postJSON("/locations/doDelete",
{locationID:d.locationID},function(a){a.success&&k()})})};p.addEventListener("submit",function(a){a.preventDefault()});document.getElementById("filter--locationNameAddress").addEventListener("change",h);document.getElementById("filter--locationIsDistributor").addEventListener("change",h);document.getElementById("filter--locationIsManufacturer").addEventListener("change",h);h()})();
