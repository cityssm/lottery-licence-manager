(function(){function u(b){b.preventDefault();var n=parseInt(b.currentTarget.getAttribute("data-location-index")),g=f[n];window.llm.confirmModal("Delete Location","Are you sure you want to delete "+window.llm.escapeHTML(g.locationDisplayName)+"?","Yes, Delete","warning",function(){window.fetch("/locations/doDelete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({locationID:g.locationID})}).then(function(b){return b.json()}).then(function(b){b.success&&
(f.splice(n,1),e())})})}var p=document.getElementById("filter--locationNameAddress"),q=document.getElementById("filter--locationIsDistributor"),r=document.getElementById("filter--locationIsManufacturer"),h=document.getElementById("container--searchResults"),t="true"===document.getElementsByTagName("main")[0].getAttribute("data-can-create"),f=[],e;e=function(){if(0===f.length)h.innerHTML='<div class="message is-info"><div class="message-body"><strong>There are no locations on record.</strong></div></div>';
else{var b=50,e=q.value,g=r.value;h.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>Location</th><th>Address</th><th class="has-text-centered">Licences</th><th class="has-text-centered">Distributor</th><th class="has-text-centered">Manufacturer</th>'+(t?'<th><span class="sr-only">Options</span></th>':"")+"</tr></thead><tbody></tbody></table>";for(var v=h.getElementsByTagName("tbody")[0],k=0;k<f.length;k+=1){var a=f[k],c=!0;if(""===e||parseInt(e)===a.locationIsDistributor)if(""===
g||parseInt(g)===a.locationIsManufacturer){for(var d=p.value.trim().toLowerCase().split(" "),m=0;m<d.length;m+=1){var l=d[m];if(-1===a.locationName.toLowerCase().indexOf(l)&&-1===a.locationAddress1.toLowerCase().indexOf(l)&&-1===a.locationAddress2.toLowerCase().indexOf(l)&&-1===a.locationCity.toLowerCase().indexOf(l)){c=!1;break}}if(c&&(--b,c=document.createElement("tr"),c.innerHTML="<td></td>",d=document.createElement("a"),d.innerText=a.locationDisplayName,d.href="/locations/"+a.locationID,c.getElementsByTagName("td")[0].insertAdjacentElement("beforeend",
d),d=document.createElement("td"),d.innerHTML=window.llm.escapeHTML(a.locationAddress1)+(""===a.locationAddress2?"":"<br /><small>"+window.llm.escapeHTML(a.locationAddress2)+"</small>")+(""===a.locationCity?"":"<br /><small>"+window.llm.escapeHTML(a.locationCity)+", "+a.locationProvince+"</small>"),c.insertAdjacentElement("beforeend",d),c.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(""===a.licences_endDateMaxString?'<span class="has-text-grey">Not Used</span>':a.licences_endDateMaxString)+
"</td>"),c.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(a.locationIsDistributor?'<span data-tooltip="Distributor"><span class="tag is-success">Yes</span><br />'+(""===a.distributor_endDateMaxString?'<span class="has-text-grey">Never Used</span>':a.distributor_endDateMaxString)+"</span>":'<span class="sr-only">No</span>')+"</td>"),c.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(a.locationIsManufacturer?'<span data-tooltip="Manufacturer"><span class="tag is-success">Yes</span><br />'+
(""===a.manufacturer_endDateMaxString?'<span class="has-text-grey">Never Used</span>':a.manufacturer_endDateMaxString)+"</span>":'<span class="sr-only">No</span>')+"</td>"),t&&(d=a.canUpdate&&0===a.licences_count&&0===a.distributor_count&&0===a.manufacturer_count,c.insertAdjacentHTML("beforeend",'<td><div class="buttons justify-flex-end">'+(a.canUpdate?'<a class="button is-small" href="/locations/'+a.locationID+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span> <span>Edit</span></a>':
"")+(d?'<button class="button is-small is-danger is-delete-location-button" data-location-index="'+k+'"><span class="icon"><i class="fas fa-trash" aria-hidden="true"></i></span></button>':"")+"</div></td>"),d&&c.getElementsByClassName("is-delete-location-button")[0].addEventListener("click",u)),v.insertAdjacentElement("beforeend",c),0===b))break}}0===b&&h.insertAdjacentHTML("beforeend",'<div class="message is-warning"><p class="message-body">Display Limit Reached</p></div>')}};window.fetch("/locations/doGetLocations",
{method:"POST",credentials:"include"}).then(function(b){return b.json()}).then(function(b){f=b;e()});p.addEventListener("keyup",e);q.addEventListener("change",e);r.addEventListener("change",e)})();
