"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=document.querySelector("main").dataset.urlPrefix,t=document.querySelector("#form--filters"),a=document.querySelector("#container--searchResults"),s="true"===document.querySelector("main").dataset.canCreate,i=()=>{a.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading organizations...</em></p>',cityssm.postJSON(e+"/organizations/doSearch",t,e=>{if(0===e.length)return void(a.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>');a.innerHTML='<table class="table is-fullwidth is-striped is-hoverable has-sticky-header"><thead><tr><th colspan="2">Organization Name</th><th>Default Representative</th>'+(s?'<th class="is-hidden-print"><span class="sr-only">Organization Options</span></th>':"")+"<th>Licences</th>"+(s?'<th class="is-hidden-print"><span class="sr-only">Licence Options</span></th>':"")+"</tr></thead><tbody></tbody></table>";const t=a.querySelector("tbody");for(const a of e){const e=document.createElement("tr");e.innerHTML="<td></td>";const i=document.createElement("a");a.isEligibleForLicences?i.dataset.tooltip="View Organization":(i.className="has-text-danger",i.dataset.tooltip="Not Eligible for New Licences"),i.textContent=a.organizationName,i.href="organizations/"+a.organizationID.toString(),e.querySelector("td").append(i),e.insertAdjacentHTML("beforeend",'<td class="has-text-right">'+(""===a.organizationNote?"":'<span class="tag has-cursor-default is-info is-light" data-tooltip="'+cityssm.escapeHTML(a.organizationNote.length>30?a.organizationNote.slice(0,27)+"...":a.organizationNote)+'"><i class="fas fa-sticky-note mr-2" aria-hidden="true"></i> Note</span>')+"</td>"),e.insertAdjacentHTML("beforeend","<td>"+(a.representativeName||'<span class="has-text-grey">(No Representatives)</span>')+"</td>"),s&&e.insertAdjacentHTML("beforeend",'<td class="has-text-right is-hidden-print">'+(a.canUpdate?'<a class="button is-small" data-tooltip="Edit Organization" href="organizations/'+a.organizationID.toString()+'/edit"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></a>':"")+"</td>");let n="";a.licences_activeCount>0?n='<span class="tag has-cursor-default is-info" data-tooltip="Number of Active Licences"><i class="fas fa-certificate mr-2" aria-hidden="true"></i> '+a.licences_activeCount.toString()+"</span>":a.licences_endDateMax&&(n='<span class="tag has-cursor-default is-info is-light" data-tooltip="Last Licence End Date"><i class="fas fa-stop mr-2" aria-hidden="true"></i> '+a.licences_endDateMaxString+"</span>"),e.insertAdjacentHTML("beforeend","<td>"+n+"</td>"),s&&e.insertAdjacentHTML("beforeend",'<td class="has-text-right is-hidden-print">'+(a.isEligibleForLicences?'<a class="button is-small" data-tooltip="Create a New Licence" href="licences/new/'+a.organizationID.toString()+'"><span class="icon"><i class="fas fa-certificate" aria-hidden="true"></i></span><span>New</span></a>':"")+"</td>"),t.append(e)}})};t.addEventListener("submit",e=>{e.preventDefault()});const n=t.querySelectorAll("input, select");for(const e of n)e.addEventListener("change",i);i()})();