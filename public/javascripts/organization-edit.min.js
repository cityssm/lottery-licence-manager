(function(){function x(){window.llm.enableNavBlocker();m.innerHTML='<div class="has-text-info"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> Unsaved Changes</div>'}var n=document.getElementById("form--organization"),m=document.getElementById("container--form-message"),h=document.getElementById("organization--organizationID").value,p=""===h;n.addEventListener("submit",function(a){a.preventDefault();m.innerHTML='Saving... <i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i>';
window.fetch("/organizations/doSave",{method:"post",credentials:"include",body:new URLSearchParams(new FormData(n))}).then(function(b){return b.json()}).then(function(b){b.success&&window.llm.disableNavBlocker();b.success&&p?window.location.href="/organizations/"+b.organizationID+"/edit":(m.innerHTML="",window.llm.alertModal(b.message,"","OK",b.success?"success":"danger"))})});if(!p){var f=document.getElementsByClassName("is-representative-table")[0].getElementsByTagName("tbody")[0],q=function(){0===
f.getElementsByTagName("tr").length&&(f.innerHTML='<tr class="has-background-warning is-empty-warning"><td class="has-text-centered" colspan="6"><strong>There are no representatives associated with this organization.</strong></td></tr>')};q();var r=function(a){window.fetch("/organizations/"+h+"/doSetDefaultRepresentative",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefaultRepresentativeIndex:a.currentTarget.value})}).then(function(b){return b.json()})},
d=f.getElementsByTagName("input"),c;for(c=0;c<d.length;c+=1)d[c].addEventListener("change",r);var t=function(a){a.preventDefault();var b=a.currentTarget.closest("tr");a=b.getAttribute("data-representative-name");window.llm.confirmModal("Delete a Representative?",'<p>Are you sure you want to delete the representative "'+a+'"?</p>',"Yes, Delete","danger",function(){window.fetch("/organizations/"+h+"/doDeleteOrganizationRepresentative",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},
body:JSON.stringify({representativeIndex:b.getAttribute("data-representative-index")})}).then(function(b){return b.json()}).then(function(a){a.success&&(b.remove(),q())})})},d=f.getElementsByClassName("is-delete-representative-button");for(c=0;c<d.length;c+=1)d[c].addEventListener("click",t);var l=document.getElementsByClassName("is-edit-representative-modal")[0],d=l.getElementsByTagName("form")[0],e,u=function(a){e=a.currentTarget.closest("tr");a=e.getAttribute("data-representative-index");document.getElementById("editOrganizationRepresentative--representativeIndex").value=
a;document.getElementById("editOrganizationRepresentative--representativeName").value=e.getAttribute("data-representative-name");document.getElementById("editOrganizationRepresentative--representativeTitle").value=e.getAttribute("data-representative-title");document.getElementById("editOrganizationRepresentative--representativeAddress1").value=e.getAttribute("data-representative-address-1");document.getElementById("editOrganizationRepresentative--representativeAddress2").value=e.getAttribute("data-representative-address-2");
document.getElementById("editOrganizationRepresentative--representativeCity").value=e.getAttribute("data-representative-city");document.getElementById("editOrganizationRepresentative--representativeProvince").value=e.getAttribute("data-representative-province");document.getElementById("editOrganizationRepresentative--representativePostalCode").value=e.getAttribute("data-representative-postal-code");document.getElementById("editOrganizationRepresentative--representativePhoneNumber").value=e.getAttribute("data-representative-phone-number");
document.getElementById("editOrganizationRepresentative--isDefault").value=document.getElementById("representative-isDefault--"+a).checked?"1":"0";window.llm.showModal(l)},v=function(a){var b=document.createElement("tr");b.setAttribute("data-representative-index",a.representativeIndex);b.setAttribute("data-representative-name",a.representativeName);b.setAttribute("data-representative-title",a.representativeTitle);b.setAttribute("data-representative-address-1",a.representativeAddress1);b.setAttribute("data-representative-address-2",
a.representativeAddress2);b.setAttribute("data-representative-city",a.representativeCity);b.setAttribute("data-representative-province",a.representativeProvince);b.setAttribute("data-representative-postal-code",a.representativePostalCode);b.setAttribute("data-representative-phone-number",a.representativePhoneNumber);b.insertAdjacentHTML("beforeend",'<td class="has-text-centered"><div class="field"><input class="is-checkradio is-info" id="representative-isDefault--'+a.representativeIndex+'" name="representative-isDefault" type="radio"'+
(a.isDefault?" checked":"")+' />&nbsp;<label for="representative-isDefault--'+a.representativeIndex+'"></label></div></td>');b.getElementsByTagName("input")[0].addEventListener("change",r);var c=document.createElement("td");c.innerHTML=a.representativeName+"<br /><small>"+a.representativeTitle+"</small>";b.insertAdjacentElement("beforeend",c);c=document.createElement("td");c.innerHTML=a.representativeAddress1+"<br /><small>"+a.representativeAddress2+"</small>";b.insertAdjacentElement("beforeend",
c);c=document.createElement("td");c.innerHTML=a.representativeCity+", "+a.representativeProvince+"<br /><small>"+a.representativePostalCode+"</small>";b.insertAdjacentElement("beforeend",c);c=document.createElement("td");c.innerHTML=a.representativePhoneNumber;b.insertAdjacentElement("beforeend",c);b.insertAdjacentHTML("beforeend",'<td><div class="buttons is-right has-addons"><button class="button is-small is-edit-representative-button" data-tooltip="Edit Representative" type="button"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></button><button class="button is-small has-text-danger is-delete-representative-button" data-tooltip="Delete Representative" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></td>');
b.getElementsByClassName("is-edit-representative-button")[0].addEventListener("click",u);b.getElementsByClassName("is-delete-representative-button")[0].addEventListener("click",t);f.insertAdjacentElement("beforeend",b)},g=f.getElementsByClassName("is-edit-representative-button");for(c=0;c<g.length;c+=1)g[c].addEventListener("click",u);c=l.getElementsByClassName("is-cancel-button");for(g=0;g<c.length;g+=1)c[g].addEventListener("click",window.llm.hideModal);d.addEventListener("submit",function(a){a.preventDefault();
window.fetch("/organizations/"+h+"/doEditOrganizationRepresentative",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a.currentTarget))}).then(function(b){return b.json()}).then(function(b){b.success&&(e.remove(),e=null,v(b.organizationRepresentative),window.llm.hideModal(l))})});var k=document.getElementsByClassName("is-add-representative-modal")[0],w=k.getElementsByTagName("form")[0];document.getElementsByClassName("is-add-representative-button")[0].addEventListener("click",
function(){w.reset();window.llm.showModal(k);document.getElementById("addOrganizationRepresentative--representativeName").focus()});c=k.getElementsByClassName("is-cancel-button");for(d=0;d<c.length;d+=1)c[d].addEventListener("click",window.llm.hideModal);w.addEventListener("submit",function(a){a.preventDefault();window.fetch("/organizations/"+h+"/doAddOrganizationRepresentative",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a.currentTarget))}).then(function(b){return b.json()}).then(function(b){if(b.success){var a=
f.getElementsByClassName("is-empty-warning");0<a.length&&a[0].remove();v(b.organizationRepresentative);window.llm.hideModal(k)}})});k.getElementsByClassName("is-copy-organization-address-button")[0].addEventListener("click",function(a){a.preventDefault();document.getElementById("addOrganizationRepresentative--representativeAddress1").value=document.getElementById("organization--organizationAddress1").value;document.getElementById("addOrganizationRepresentative--representativeAddress2").value=document.getElementById("organization--organizationAddress2").value;
document.getElementById("addOrganizationRepresentative--representativeCity").value=document.getElementById("organization--organizationCity").value;document.getElementById("addOrganizationRepresentative--representativeProvince").value=document.getElementById("organization--organizationProvince").value;document.getElementById("addOrganizationRepresentative--representativePostalCode").value=document.getElementById("organization--organizationPostalCode").value})}c=n.getElementsByClassName("input");for(d=
0;d<c.length;d+=1)c[d].addEventListener("change",x);window.llm.initializeTabs(document.getElementById("tabs--licences"))})();
