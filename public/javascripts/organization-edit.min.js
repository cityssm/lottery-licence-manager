(function(){function q(){window.llm.enableNavBlocker();h.innerHTML='<div class="is-size-7 has-text-info"><i class="fas fa-exclamation-triangle"></i> Unsaved Changes</div>'}var f=document.getElementById("form--organization"),h=document.getElementById("container--form-message"),k=""===document.getElementById("organization--organizationID").value,g=document.getElementById("organization--organizationID").value;f.addEventListener("submit",function(a){a.preventDefault();window.fetch("/organizations/doSave",
{method:"post",credentials:"include",body:new URLSearchParams(new FormData(f))}).then(function(b){return b.json()}).then(function(b){window.llm.disableNavBlocker();b.success&&k?window.location.href="/organizations/"+b.organizationID+"/edit":h.innerHTML='<div class="is-size-7 '+(b.success?"has-text-success":"has-text-danger")+'">'+b.message+"</div>"})});if(!k){var d=document.getElementsByClassName("is-representative-table")[0].getElementsByTagName("tbody")[0],l=function(){0===d.getElementsByTagName("tr").length&&
(d.innerHTML='<tr class="has-background-warning is-empty-warning"><td class="has-text-centered" colspan="6"><strong>There are no representatives associated with this organization.</strong></td></tr>')};l();var m=function(a){window.fetch("/organizations/"+g+"/doSetDefaultRepresentative",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefaultRepresentativeIndex:a.currentTarget.value})}).then(function(b){return b.json()})},c=d.getElementsByTagName("input"),
a;for(a=0;a<c.length;a+=1)c[a].addEventListener("change",m);var n=function(a){a.preventDefault();var b=a.currentTarget.closest("tr");a=b.getAttribute("data-representative-name");window.llm.confirmModal("Delete a Representative?",'<p>Are you sure you want to delete the representative "'+a+'"?</p>',"Yes, Delete","warning",function(){window.fetch("/organizations/"+g+"/doDeleteOrganizationRepresentative",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({representativeIndex:b.getAttribute("data-representative-index")})}).then(function(b){return b.json()}).then(function(a){a.success&&
(b.remove(),l())})})},c=d.getElementsByClassName("is-delete-representative-button");for(a=0;a<c.length;a+=1)c[a].addEventListener("click",n);var e=document.getElementsByClassName("is-add-representative-modal")[0],p=e.getElementsByTagName("form")[0];document.getElementsByClassName("is-add-representative-button")[0].addEventListener("click",function(){p.reset();window.llm.showModal(e)});a=e.getElementsByClassName("is-cancel-button");for(c=0;c<a.length;c+=1)a[c].addEventListener("click",window.llm.hideModal);
p.addEventListener("submit",function(a){a.preventDefault();window.fetch("/organizations/"+g+"/doAddOrganizationRepresentative",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a.currentTarget))}).then(function(b){return b.json()}).then(function(b){if(b.success){var a=d.getElementsByClassName("is-empty-warning");0<a.length&&a[0].remove();b=b.organizationRepresentative;a=document.createElement("tr");a.setAttribute("data-representative-index",b.RepresentativeIndex);a.setAttribute("data-representative-name",
b.RepresentativeName);a.setAttribute("data-representative-title",b.RepresentativeTitle);a.setAttribute("data-representative-address-1",b.RepresentativeAddress1);a.setAttribute("data-representative-address-2",b.RepresentativeAddress2);a.setAttribute("data-representative-city",b.RepresentativeCity);a.setAttribute("data-representative-province",b.RepresentativeProvince);a.setAttribute("data-representative-postal-code",b.RepresentativePostalCode);a.insertAdjacentHTML("beforeend",'<td class="has-text-centered"><div class="field"><input class="is-checkradio is-info" id="representative-isDefault--'+
b.RepresentativeIndex+'" name="representative-isDefault" type="radio"'+(b.IsDefault?" checked":"")+' />&nbsp;<label for="representative-isDefault--'+b.RepresentativeIndex+'"></label></div></td>');a.getElementsByTagName("input")[0].addEventListener("change",m);var c=document.createElement("td");c.innerHTML=b.RepresentativeName+"<br />"+b.RepresentativeTitle;a.insertAdjacentElement("beforeend",c);c=document.createElement("td");c.innerHTML=b.RepresentativeAddress1+"<br />"+b.RepresentativeAddress2;a.insertAdjacentElement("beforeend",
c);c=document.createElement("td");c.innerHTML=b.RepresentativeCity+", "+b.RepresentativeProvince;a.insertAdjacentElement("beforeend",c);c=document.createElement("td");c.innerHTML=b.RepresentativePostalCode;a.insertAdjacentElement("beforeend",c);a.insertAdjacentHTML("beforeend",'<td><div class="buttons is-right has-addons"><button class="button is-small is-edit-representative-button" type="button"><span class="icon"><i class="fas fa-pencil-alt"></i></span><span>Edit</span></button><button class="button is-small is-delete-representative-button" type="button"><i class="fas fa-trash"></i></button></td>');
a.getElementsByClassName("is-delete-representative-button")[0].addEventListener("click",n);d.insertAdjacentElement("beforeend",a);window.llm.hideModal(e)}})})}a=f.getElementsByClassName("input");for(c=0;c<a.length;c+=1)a[c].addEventListener("change",q)})();
