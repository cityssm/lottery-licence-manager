(function(){function x(){window.llm.enableNavBlocker();n.innerHTML='<div class="has-text-info"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> Unsaved Changes</div>'}var m=document.getElementById("form--organization"),n=document.getElementById("container--form-message"),h=document.getElementById("organization--organizationID").value,p=""===h;m.addEventListener("submit",function(a){a.preventDefault();window.fetch("/organizations/doSave",{method:"post",credentials:"include",body:new URLSearchParams(new FormData(m))}).then(function(a){return a.json()}).then(function(a){window.llm.disableNavBlocker();
a.success&&p?window.location.href="/organizations/"+a.organizationID+"/edit":n.innerHTML='<span class="'+(a.success?"has-text-success":"has-text-danger")+'">'+a.message+"</span>"})});if(!p){var f=document.getElementsByClassName("is-representative-table")[0].getElementsByTagName("tbody")[0],q=function(){0===f.getElementsByTagName("tr").length&&(f.innerHTML='<tr class="has-background-warning is-empty-warning"><td class="has-text-centered" colspan="6"><strong>There are no representatives associated with this organization.</strong></td></tr>')};
q();var r=function(a){window.fetch("/organizations/"+h+"/doSetDefaultRepresentative",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({isDefaultRepresentativeIndex:a.currentTarget.value})}).then(function(a){return a.json()})},d=f.getElementsByTagName("input"),b;for(b=0;b<d.length;b+=1)d[b].addEventListener("change",r);var t=function(a){a.preventDefault();var c=a.currentTarget.closest("tr");a=c.getAttribute("data-representative-name");window.llm.confirmModal("Delete a Representative?",
'<p>Are you sure you want to delete the representative "'+a+'"?</p>',"Yes, Delete","danger",function(){window.fetch("/organizations/"+h+"/doDeleteOrganizationRepresentative",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({representativeIndex:c.getAttribute("data-representative-index")})}).then(function(a){return a.json()}).then(function(a){a.success&&(c.remove(),q())})})},d=f.getElementsByClassName("is-delete-representative-button");for(b=0;b<
d.length;b+=1)d[b].addEventListener("click",t);var l=document.getElementsByClassName("is-edit-representative-modal")[0],d=l.getElementsByTagName("form")[0],e,u=function(a){e=a.currentTarget.closest("tr");a=e.getAttribute("data-representative-index");document.getElementById("editOrganizationRepresentative--representativeIndex").value=a;document.getElementById("editOrganizationRepresentative--representativeName").value=e.getAttribute("data-representative-name");document.getElementById("editOrganizationRepresentative--representativeTitle").value=
e.getAttribute("data-representative-title");document.getElementById("editOrganizationRepresentative--representativeAddress1").value=e.getAttribute("data-representative-address-1");document.getElementById("editOrganizationRepresentative--representativeAddress2").value=e.getAttribute("data-representative-address-2");document.getElementById("editOrganizationRepresentative--representativeCity").value=e.getAttribute("data-representative-city");document.getElementById("editOrganizationRepresentative--representativeProvince").value=
e.getAttribute("data-representative-province");document.getElementById("editOrganizationRepresentative--representativePostalCode").value=e.getAttribute("data-representative-postal-code");document.getElementById("editOrganizationRepresentative--representativePhoneNumber").value=e.getAttribute("data-representative-phone-number");document.getElementById("editOrganizationRepresentative--isDefault").value=document.getElementById("representative-isDefault--"+a).checked?"1":"0";window.llm.showModal(l)},
v=function(a){var c=document.createElement("tr");c.setAttribute("data-representative-index",a.RepresentativeIndex);c.setAttribute("data-representative-name",a.RepresentativeName);c.setAttribute("data-representative-title",a.RepresentativeTitle);c.setAttribute("data-representative-address-1",a.RepresentativeAddress1);c.setAttribute("data-representative-address-2",a.RepresentativeAddress2);c.setAttribute("data-representative-city",a.RepresentativeCity);c.setAttribute("data-representative-province",
a.RepresentativeProvince);c.setAttribute("data-representative-postal-code",a.RepresentativePostalCode);c.setAttribute("data-representative-phone-number",a.RepresentativePhoneNumber);c.insertAdjacentHTML("beforeend",'<td class="has-text-centered"><div class="field"><input class="is-checkradio is-info" id="representative-isDefault--'+a.RepresentativeIndex+'" name="representative-isDefault" type="radio"'+(a.IsDefault?" checked":"")+' />&nbsp;<label for="representative-isDefault--'+a.RepresentativeIndex+
'"></label></div></td>');c.getElementsByTagName("input")[0].addEventListener("change",r);var b=document.createElement("td");b.innerHTML=a.RepresentativeName+"<br /><small>"+a.RepresentativeTitle+"</small>";c.insertAdjacentElement("beforeend",b);b=document.createElement("td");b.innerHTML=a.RepresentativeAddress1+"<br /><small>"+a.RepresentativeAddress2+"</small>";c.insertAdjacentElement("beforeend",b);b=document.createElement("td");b.innerHTML=a.RepresentativeCity+", "+a.RepresentativeProvince+"<br /><small>"+
a.RepresentativePostalCode+"</small>";c.insertAdjacentElement("beforeend",b);b=document.createElement("td");b.innerHTML=a.RepresentativePhoneNumber;c.insertAdjacentElement("beforeend",b);c.insertAdjacentHTML("beforeend",'<td><div class="buttons is-right has-addons"><button class="button is-small is-edit-representative-button" data-tooltip="Edit Representative" type="button"><span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></button><button class="button is-small has-text-danger is-delete-representative-button" data-tooltip="Delete Representative" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></td>');
c.getElementsByClassName("is-edit-representative-button")[0].addEventListener("click",u);c.getElementsByClassName("is-delete-representative-button")[0].addEventListener("click",t);f.insertAdjacentElement("beforeend",c)},g=f.getElementsByClassName("is-edit-representative-button");for(b=0;b<g.length;b+=1)g[b].addEventListener("click",u);b=l.getElementsByClassName("is-cancel-button");for(g=0;g<b.length;g+=1)b[g].addEventListener("click",window.llm.hideModal);d.addEventListener("submit",function(a){a.preventDefault();
window.fetch("/organizations/"+h+"/doEditOrganizationRepresentative",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a.currentTarget))}).then(function(a){return a.json()}).then(function(a){a.success&&(e.remove(),e=null,v(a.organizationRepresentative),window.llm.hideModal(l))})});var k=document.getElementsByClassName("is-add-representative-modal")[0],w=k.getElementsByTagName("form")[0];document.getElementsByClassName("is-add-representative-button")[0].addEventListener("click",
function(){w.reset();window.llm.showModal(k)});b=k.getElementsByClassName("is-cancel-button");for(d=0;d<b.length;d+=1)b[d].addEventListener("click",window.llm.hideModal);w.addEventListener("submit",function(a){a.preventDefault();window.fetch("/organizations/"+h+"/doAddOrganizationRepresentative",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a.currentTarget))}).then(function(a){return a.json()}).then(function(a){if(a.success){var b=f.getElementsByClassName("is-empty-warning");
0<b.length&&b[0].remove();v(a.organizationRepresentative);window.llm.hideModal(k)}})});k.getElementsByClassName("is-copy-organization-address-button")[0].addEventListener("click",function(a){a.preventDefault();document.getElementById("addOrganizationRepresentative--representativeAddress1").value=document.getElementById("organization--organizationAddress1").value;document.getElementById("addOrganizationRepresentative--representativeAddress2").value=document.getElementById("organization--organizationAddress2").value;
document.getElementById("addOrganizationRepresentative--representativeCity").value=document.getElementById("organization--organizationCity").value;document.getElementById("addOrganizationRepresentative--representativeProvince").value=document.getElementById("organization--organizationProvince").value;document.getElementById("addOrganizationRepresentative--representativePostalCode").value=document.getElementById("organization--organizationPostalCode").value})}b=m.getElementsByClassName("input");for(d=
0;d<b.length;d+=1)b[d].addEventListener("change",x);window.llm.initializeTabs(document.getElementById("tabs--licences"))})();
