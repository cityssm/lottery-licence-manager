"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=cityssm.dateToString(new Date),t=document.getElementById("filter--eventDate"),i=document.getElementById("filter--showLicences"),s=document.getElementById("container--events"),a=exports.config_days;delete exports.config_days;const n=exports.config_licenceTypes;delete exports.config_licenceTypes;const c=()=>{cityssm.clearElement(s),""===t.value&&(t.value=cityssm.dateToString(new Date)),cityssm.postJSON("doGetEventsByWeek",{eventDate:t.value},t=>{if(0===t.licences.length&&0===t.events.length)return void(s.innerHTML=`<div class="message is-info">\n            <p class="message-body">\n            There are no licences or events with activity between\n            ${t.startDateString} and ${t.endDateString}.\n            </p>\n            </div>`);const c=document.createElement("table");c.className="table is-fixed is-fullwidth is-bordered";let d="<thead><tr>";const r=cityssm.dateStringToDate(t.startDateString);for(let t=0;t<=6;t+=1){const i=cityssm.dateToString(r);d+='<th class="has-text-centered'+(i===e?" has-background-primary has-text-white":" has-background-white-ter")+'">'+a[t]+"<br />"+i+"</th>",r.setDate(r.getDate()+1)}d+="</tr></thead>",c.innerHTML=d;const l=document.createElement("tbody");l.id="tbody--licences",i.checked||(l.className="is-hidden");for(const e of t.licences){let i=0,s="";if(e.startDateString>t.startDateString){i=cityssm.dateStringDifferenceInDays(t.startDateString,e.startDateString);for(let e=0;e<i;e+=1)s+="<td></td>"}let a=1;e.startDateString!==e.endDateString&&(a=Math.min(7-i,cityssm.dateStringDifferenceInDays(0===i?t.startDateString:e.startDateString,e.endDateString)+1));let c="";for(let e=i+a;e<7;e+=1)c+="<td></td>";const d=n[e.licenceTypeKey];l.insertAdjacentHTML("beforeend","<tr>"+s+'<td colspan="'+a.toString()+'"><a class="button has-text-left is-small is-block has-height-auto is-wrap is-primary is-light" data-tooltip="View Licence" href="/licences/'+e.licenceID.toString()+'"><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-certificate" aria-hidden="true"></i></div><div class="column pb-2 has-text-weight-semibold">'+e.externalLicenceNumber+"<br />"+(d||e.licenceTypeKey)+'</div></div><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i></div><div class="column pb-2">'+(""===e.locationName?e.locationAddress1:e.locationName)+'</div></div><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-users" aria-hidden="true"></i></div><div class="column pb-2">'+e.organizationName+'</div></div><div class="columns is-variable is-1"><div class="column is-narrow"><i class="fas fa-fw fa-calendar" aria-hidden="true"></i></div><div class="column">'+e.startDateString+(e.startDateString===e.endDateString?"":" to "+e.endDateString)+"</div></div></a></td>"+c+"</tr>")}c.appendChild(l);const o=[document.createElement("td"),document.createElement("td"),document.createElement("td"),document.createElement("td"),document.createElement("td"),document.createElement("td"),document.createElement("td")];for(const e of t.events){const t=n[e.licenceTypeKey];o[cityssm.dateStringToDate(e.eventDateString).getDay()].insertAdjacentHTML("beforeend",'<a class="button mb-2 has-text-left is-small is-block has-height-auto is-wrap is-link is-light" data-tooltip="View Event" href="/events/'+e.licenceID.toString()+"/"+e.eventDate.toString()+'"><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-clock" aria-hidden="true"></i></div><div class="column pb-2">'+e.startTimeString+'</div></div><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-certificate" aria-hidden="true"></i></div><div class="column pb-2 has-text-weight-semibold">'+cityssm.escapeHTML(e.externalLicenceNumber)+"<br />"+(t||e.licenceTypeKey)+'</div></div><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i></div><div class="column pb-2">'+cityssm.escapeHTML(""===e.locationName?e.locationAddress1:e.locationName)+'</div></div><div class="columns mb-0 is-variable is-1"><div class="column pb-2 is-narrow"><i class="fas fa-fw fa-users" aria-hidden="true"></i></div><div class="column pb-2">'+cityssm.escapeHTML(e.organizationName)+"</div></div></a>")}const m=document.createElement("tr");for(const e of o)m.appendChild(e);const v=document.createElement("tbody");v.appendChild(m),c.appendChild(v),s.appendChild(c)})};t.addEventListener("change",c),c(),i.addEventListener("change",()=>{i.checked?document.getElementById("tbody--licences").classList.remove("is-hidden"):document.getElementById("tbody--licences").classList.add("is-hidden")})})();