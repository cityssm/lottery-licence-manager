(function(){function g(){cityssm.clearElement(k);""===d.value&&(d.value=cityssm.dateToString(new Date));cityssm.postJSON("/events/doGetEventsByWeek",{eventDate:d.value},function(c){if(0===c.licences.length&&0===c.events.length)k.innerHTML='<div class="message is-info"><p class="message-body">There are no licences or events with activity between '+c.startDateString+" and "+c.endDateString+".</p></div>";else{var d=document.createElement("table");d.className="table is-fixed is-fullwidth";for(var h="<thead><tr>",
e=cityssm.dateStringToDate(c.startDateString),a=0;6>=a;a+=1)h+='<th class="has-text-centered">'+m[a]+"<br />"+cityssm.dateToString(e)+"</th>",e.setDate(e.getDate()+1);d.innerHTML=h+"</tr></thead>";h=document.createElement("tbody");for(e=0;e<c.licences.length;e+=1){var a=c.licences[e],b=0,g="";if(a.startDateString>c.startDateString)for(var b=cityssm.dateStringDifferenceInDays(c.startDateString,a.startDateString),f=0;f<b;f+=1)g+="<td></td>";f=1;a.startDateString!==a.endDateString&&(f=Math.min(7-b,cityssm.dateStringDifferenceInDays(0===
b?c.startDateString:a.startDateString,a.endDateString)+1));for(var l="",b=b+f;7>b;b+=1)l+="<td></td>";b=n[a.licenceTypeKey];h.insertAdjacentHTML("beforeend","<tr>"+g+'<td colspan="'+f+'"><a class="button has-text-left is-small is-block has-height-auto is-wrap is-link is-light" data-tooltip="View Licence" href="/licences/'+a.licenceID+'">'+('<div class="columns has-margin-bottom-0 is-variable is-1"><div class="column has-padding-bottom-5 is-narrow"><i class="fas fa-fw fa-certificate" aria-hidden="true"></i></div><div class="column has-padding-bottom-5 has-text-weight-semibold">'+
a.externalLicenceNumber+"<br />"+(b?b:a.licenceTypeKey)+"</div></div>")+('<div class="columns has-margin-bottom-0 is-variable is-1"><div class="column has-padding-bottom-5 is-narrow"><i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i></div><div class="column has-padding-bottom-5">'+(""===a.locationName?a.locationAddress1:a.locationName)+"</div></div>")+('<div class="columns has-margin-bottom-0 is-variable is-1"><div class="column has-padding-bottom-5 is-narrow"><i class="fas fa-fw fa-users" aria-hidden="true"></i></div><div class="column has-padding-bottom-5">'+
a.organizationName+"</div></div>")+('<div class="columns is-variable is-1"><div class="column is-narrow"><i class="fas fa-fw fa-calendar" aria-hidden="true"></i></div><div class="column">'+a.startDateString+(a.startDateString===a.endDateString?"":" to "+a.endDateString)+"</div></div>")+"</a></td>"+l+"</tr>")}d.appendChild(h);k.appendChild(d)}})}var d=document.getElementById("filter--eventDate"),k=document.getElementById("container--events"),m=llm.config_days;delete llm.config_days;var n=llm.config_licenceTypes;
delete llm.config_licenceTypes;d.addEventListener("change",g);g()})();
