var $jscomp={scope:{},findInternal:function(c,l,h){c instanceof String&&(c=String(c));for(var m=c.length,k=0;k<m;k++){var n=c[k];if(l.call(h,n,k,c))return{i:k,v:n}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,l,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[l]=h.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,l,h,m){if(l){h=$jscomp.global;c=c.split(".");for(m=0;m<c.length-1;m++){var k=c[m];k in h||(h[k]={});h=h[k]}c=c[c.length-1];m=h[c];l=l(m);l!=m&&null!=l&&$jscomp.defineProperty(h,c,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,h){return $jscomp.findInternal(this,c,h).v}},"es6-impl","es3");
(function(){function c(a){window.llm.enableNavBlocker();G=!0;m.innerHTML='<span class="tag is-light is-info is-medium"><span class="icon"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i></span> <span>Unsaved Changes</span></div>';n||(document.getElementById("is-add-transaction-button").setAttribute("disabled","disabled"),document.getElementById("is-disabled-transaction-message").classList.remove("is-hidden"));!a||"number"!==a.currentTarget.type&&"date"!==a.currentTarget.type&&"time"!==
a.currentTarget.type||(r=!0)}function l(a){0===q.length?window.fetch("/locations/doGetLocations",{method:"GET",credentials:"include"}).then(function(a){return a.json()}).then(function(d){q=d;a()}):a()}var h=document.getElementById("form--licence"),m=document.getElementById("container--form-message"),k=document.getElementById("licence--licenceID").value,n=""===k,Z="true"===h.getAttribute("data-licence-is-issued"),r=!1,G=!1,A=document.getElementById("container--events");h.addEventListener("submit",
function(a){a.preventDefault();0===A.getElementsByTagName("input").length?window.llm.alertModal("Event Date Error","Please ensure there is at least one event date.","OK","warning"):(m.innerHTML='Saving... <i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i>',window.fetch("/licences/doSave",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(h))}).then(function(a){return a.json()}).then(function(a){a.success&&(window.llm.disableNavBlocker(),G=!1);if(a.success&&n)window.location.href=
"/licences/"+a.licenceID+"/edit";else if(a.success&&r)window.location.reload(!0);else{m.innerHTML="";window.llm.alertModal(a.message,"","OK",a.success?"success":"danger");a=document.getElementsByClassName("is-removed-after-save");for(var b=0;b<a.length;b+=1)a[b].remove()}}))});n||document.getElementById("is-delete-licence-button").addEventListener("click",function(a){a.preventDefault();window.llm.confirmModal("Delete Licence?","Are you sure you want to delete this licence and all events associated with it?",
"Yes, Delete","danger",function(){window.fetch("/licences/doDelete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({licenceID:k})}).then(function(a){return a.json()}).then(function(a){a.success&&(window.llm.disableNavBlocker(),window.location.href="/licences")})})});for(var e=h.querySelectorAll("input, select, textarea"),f=0;f<e.length;f+=1)""!==e[f].name&&e[f].addEventListener("change",c);(e=document.getElementById("is-external-licence-number-unlock-button"))&&
e.addEventListener("click",function(){var a=document.getElementById("licence--externalLicenceNumber");a.classList.remove("is-readonly");a.removeAttribute("readonly");a.focus()});var D=[],O,t,H,aa=function(a){a.preventDefault();a=a.currentTarget;document.getElementById("licence--organizationID").value=a.getAttribute("data-organization-id");document.getElementById("licence--organizationName").value=a.getAttribute("data-organization-name");O();c()},I=function(){var a=document.createElement("div");a.className=
"list is-hoverable";for(var d=t.value.trim().toLowerCase().split(" "),b=10,u=0;u<D.length&&0<b;u+=1){var g=!0,c=D[u];if(c.isEligibleForLicences){for(var e=c.organizationName.toLowerCase(),v=0;v<d.length;v+=1)if(-1===e.indexOf(d[v])){g=!1;break}g&&(--b,g=document.createElement("a"),g.className="list-item",g.setAttribute("data-organization-id",c.organizationID),g.setAttribute("data-organization-name",c.organizationName),g.setAttribute("href","#"),g.innerText=c.organizationName,g.addEventListener("click",
aa),a.insertAdjacentElement("beforeend",g))}}window.llm.clearElement(H);H.insertAdjacentElement("beforeend",a)},e=function(){window.llm.openHtmlModal("licence-organizationLookup",{onshow:function(){t=document.getElementById("organizationLookup--searchStr");t.addEventListener("keyup",I);H=document.getElementById("container--organizationLookup");0===D.length?window.fetch("/organizations/doGetAll",{method:"GET",credentials:"include"}).then(function(a){return a.json()}).then(function(a){D=a;t.removeAttribute("disabled");
I();t.focus()}):(t.removeAttribute("disabled"),I(),t.focus())},onshown:function(a,d){O=d;t.focus()}})};document.getElementById("is-organization-lookup-button").addEventListener("click",e);document.getElementById("licence--organizationName").addEventListener("dblclick",e);var q=[],J,x,K,P=function(a,d){document.getElementById("licence--locationID").value=a;document.getElementById("licence--locationDisplayName").value=d},ba=function(a){a.preventDefault();a=a.currentTarget;P(a.getAttribute("data-location-id"),
a.getAttribute("data-location-display-name"));J();c()},Q=function(){var a=document.createElement("div");a.className="list is-hoverable";for(var d=x.value.trim().toLowerCase().split(" "),b=10,u=0;u<q.length&&0<b;u+=1){for(var g=!0,c=q[u],e=c.locationName.toLowerCase(),v=0;v<d.length;v+=1)if(-1===e.indexOf(d[v])){g=!1;break}g&&(--b,g=""===c.locationName?c.locationAddress1:c.locationName,e=document.createElement("a"),e.className="list-item",e.setAttribute("data-location-id",c.locationID),e.setAttribute("data-location-display-name",
g),e.setAttribute("href","#"),e.innerHTML=g+(""===c.locationName?"":"<br /><small>"+c.locationAddress1+"</small>"),e.addEventListener("click",ba),a.insertAdjacentElement("beforeend",e))}window.llm.clearElement(K);K.insertAdjacentElement("beforeend",a)},e=function(){window.llm.openHtmlModal("licence-locationLookup",{onshow:function(a){x=document.getElementById("locationLookup--searchStr");x.addEventListener("keyup",Q);K=document.getElementById("container--locationLookup");l(function(){x.removeAttribute("disabled");
Q();x.focus()});window.llm.getDefaultConfigProperty("city",function(a){a&&(document.getElementById("newLocation--locationCity").value=a)});window.llm.getDefaultConfigProperty("province",function(a){a&&(document.getElementById("newLocation--locationProvince").value=a)});document.getElementById("form--newLocation").addEventListener("submit",function(a){a.preventDefault();window.fetch("/locations/doCreate",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a.currentTarget))}).then(function(a){return a.json()}).then(function(a){a.success&&
(q=[],P(a.locationID,a.locationDisplayName),J())})});window.llm.initializeTabs(a.querySelector(".tabs ul"))},onshown:function(a,d){J=d;x.focus()}})};document.getElementById("is-location-lookup-button").addEventListener("click",e);document.getElementById("licence--locationDisplayName").addEventListener("dblclick",e);var y=[],L=document.getElementById("is-termsConditions-lookup-modal"),B=document.getElementById("container--termsConditionsPrevious"),ca=function(a){a.preventDefault();a=parseInt(a.currentTarget.getAttribute("data-terms-conditions-index"));
document.getElementById("licence--termsConditions").value=y[a].termsConditions;window.llm.hideModal(L);c()};document.getElementById("is-termsConditions-lookup-button").addEventListener("click",function(){y=[];window.llm.clearElement(B);var a=document.getElementById("licence--organizationID").value;""===a?window.llm.alertModal("No Organization Selected","An organization must be selected before the previously used terms and conditions can be retrieved.","OK","warning"):(B.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br />Loading previously used terms and conditions...</p>',
window.fetch("/licences/doGetDistinctTermsConditions",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationID:a})}).then(function(a){return a.json()}).then(function(a){y=a;if(0===y.length)B.innerHTML='<p class="has-text-centered">No previously used terms and conditions found for this organization.</p>';else{a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-10";for(var b=0;b<y.length;b+=1){var d=y[b],c=document.createElement("a");
c.className="list-item";c.setAttribute("data-terms-conditions-index",b);c.innerHTML='<p class="has-newline-chars">'+window.llm.escapeHTML(d.termsConditions)+'</p><p class="has-text-right">'+(1<d.termsConditionsCount?'<span class="tag is-light">Used '+d.termsConditionsCount+" times</span>":"")+'<span class="tag is-info">'+d.startDateMaxString+"</span></p>";c.addEventListener("click",ca);a.insertAdjacentElement("beforeend",c)}window.llm.clearElement(B);B.insertAdjacentElement("beforeend",a)}}),window.llm.showModal(L))});
e=L.getElementsByClassName("is-close-modal-button");for(f=0;f<e.length;f+=1)e[f].addEventListener("click",window.llm.hideModal);var R=document.getElementById("licence--licenceTypeKey");if(n){var z=document.getElementsByClassName("container-licenceTypeFields");R.addEventListener("change",function(a){var d="true"===a.currentTarget.selectedOptions[0].getAttribute("data-has-ticket-types"),b=document.getElementById("licence--totalPrizeValue");d?(document.getElementById("is-ticket-types-panel").classList.remove("is-hidden"),
b.setAttribute("readonly","readonly"),b.classList.add("is-readonly")):(d=document.getElementById("is-ticket-types-panel"),d.classList.add("is-hidden"),window.llm.clearElement(d.getElementsByTagName("tbody")[0]),window.llm.clearElement(d.getElementsByTagName("tfoot")[0]),b.removeAttribute("readonly"),b.classList.remove("is-readonly"));a="container-licenceTypeFields--"+a.currentTarget.value;for(b=0;b<z.length;b+=1)z[b].id===a?(z[b].removeAttribute("disabled"),z[b].classList.remove("is-hidden")):(z[b].classList.add("is-hidden"),
z[b].setAttribute("disabled","disabled"))})}var C=document.getElementById("licence--startDateString"),w=document.getElementById("licence--endDateString");document.getElementById("licence--applicationDateString").addEventListener("change",function(a){C.setAttribute("min",a.currentTarget.value)});C.addEventListener("change",function(){var a=C.value;w.setAttribute("min",a);w.value<a&&(w.value=a);for(var d=A.getElementsByTagName("input"),b=0;b<d.length;b+=1)d[b].setAttribute("min",a)});w.addEventListener("change",
function(){for(var a=w.value,d=A.getElementsByTagName("input"),b=0;b<d.length;b+=1)d[b].setAttribute("max",a)});var da=function(a){a.currentTarget.closest(".panel-block").remove();r=!0;c()},S=function(a){var d="";if(a)if(a instanceof Date)d=a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2);else if(a.constructor===String)d=a;else if(a instanceof Object)try{a.preventDefault();var b=a.currentTarget.getAttribute("data-source"),d=document.getElementById(b).value}catch(u){}A.insertAdjacentHTML("beforeend",
'<div class="panel-block is-block"><div class="field has-addons">'+('<div class="control is-expanded has-icons-left"><input class="input is-small" name="eventDate" type="date" value="'+d+'" min="'+C.value+'" max="'+w.value+'" required /><span class="icon is-left"><i class="fas fa-calendar" aria-hidden="true"></i></span></div>')+'<div class="control"><a class="button is-small is-danger has-tooltip-right" role="button" data-tooltip="Remove Event"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Remove Event</span></a></div></div></div>');
a=A.getElementsByTagName("a");a[a.length-1].addEventListener("click",da);r=!0;c()},M=document.getElementById("is-event-calculator-modal");document.getElementsByClassName("is-calculate-events-button")[0].addEventListener("click",function(){for(var a=parseInt(document.getElementById("eventCalc--eventCount").value),d=parseInt(document.getElementById("eventCalc--dayInterval").value),b=w.value.split("-"),c=new Date(b[0],parseInt(b[1])-1,b[2]),b=C.value.split("-"),b=new Date(b[0],parseInt(b[1])-1,b[2]),
g=0;g<a&&b.getTime()<=c.getTime();g+=1)S(b),b.setDate(b.getDate()+d);window.llm.hideModal(M)});document.getElementById("is-event-calculator-button").addEventListener("click",function(){window.llm.showModal(M)});e=M.getElementsByClassName("is-close-modal-button");for(f=0;f<e.length;f+=1)e[f].addEventListener("click",window.llm.hideModal);e=document.getElementsByClassName("is-add-event-button");for(f=0;f<e.length;f+=1)e[f].addEventListener("click",S);var p=document.getElementById("is-ticket-types-panel");
if(p){var N={},T=function(a){var d=R.value;d in N?a(N[d]):window.fetch("/licences/doGetTicketTypes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({licenceTypeKey:d})}).then(function(a){return a.json()}).then(function(b){N[d]=b;a(b)})},E=function(){for(var a=0,d=p.getElementsByClassName("is-total-prizes-per-deal"),b=0;b<d.length;b+=1)a+=parseFloat(d[b].value);for(var d=0,b=p.getElementsByClassName("is-licence-fee"),c=0;c<b.length;c+=1)d+=parseFloat(b[c].value);
p.getElementsByTagName("tfoot")[0].innerHTML='<tr><td></td><td></td><td></td><th class="has-text-right is-nowrap">$ '+a.toFixed(2)+'</th><td></td><th class="has-text-right is-nowrap">$ '+d.toFixed(2)+"</th><td></td><td></td><td></td><td></td></tr>";document.getElementById("licence--totalPrizeValue").value=a},U,V=function(a){var d=a.currentTarget.closest("tr"),b=d.getAttribute("data-ticket-type");window.llm.confirmModal("Delete Ticket Type?","Are you sure you want to remove the "+b+" ticket type for this licence?",
"Yes, Delete","danger",function(){d.remove();if(!n){var a=h.querySelector("input[name='ticketType_toAdd'][value='"+b+"']");a?a.remove():h.insertAdjacentHTML("beforeend",'<input class="is-removed-after-save" name="ticketType_toDelete" type="hidden" value="'+b+'" />')}E();c();r=!0})},W=function(a){var d=a.currentTarget.closest("tr"),b=d.getAttribute("data-ticket-type"),e,g,f=function(a){a.preventDefault();a=document.getElementById("amendUnit_unitCount").value;var b=d.querySelector("input[name='ticketType_unitCount']");
b.value=a;b.nextElementSibling.innerText=a;b=d.getElementsByClassName("is-total-value-per-deal")[0];b.value=(e.ticketPrice*e.ticketCount*a).toFixed(2);b.nextElementSibling.innerText="$ "+(e.ticketPrice*e.ticketCount*a).toFixed(2);b=d.getElementsByClassName("is-total-prizes-per-deal")[0];b.value=(e.prizesPerDeal*a).toFixed(2);b.nextElementSibling.innerText="$ "+(e.prizesPerDeal*a).toFixed(2);a=document.getElementById("amendUnit_licenceFee").value;b=d.querySelector("input[name='ticketType_licenceFee']");
b.value=a;b.nextElementSibling.innerText="$ "+a;g();E();c();r=!0},h=function(){document.getElementById("amendUnit_licenceFee").value=(e.feePerUnit*document.getElementById("amendUnit_unitCount").value).toFixed(2)};window.llm.openHtmlModal("licence-ticketTypeUnitAmend",{onshow:function(a){document.getElementById("amendUnit_ticketType").value=b;var c=d.querySelector("input[name='ticketType_unitCount']").value;document.getElementById("amendUnit_unitCountCurrent").value=c;var g=document.getElementById("amendUnit_unitCount");
g.value=c;T(function(a){e=a.find(function(a){return a.ticketType===b});g.addEventListener("change",h);h()});a.getElementsByTagName("form")[0].addEventListener("submit",f)},onshown:function(a,b){g=b}})},X=function(a){var d,b=a.currentTarget.closest("td").previousElementSibling,e=function(a){b.getElementsByTagName("input")[0].value=a.currentTarget.getAttribute("data-location-id");b.getElementsByTagName("span")[0].innerText=a.currentTarget.getAttribute("data-location-display-name");d();c()};window.llm.openHtmlModal("licence-distributorLookup",
{onshow:function(){l(function(){var a=document.createElement("div");a.className="list is-hoverable";for(var b=0;b<q.length;b+=1){var d=q[b];if(d.locationIsDistributor){var c=document.createElement("a");c.className="list-item";c.setAttribute("data-location-id",d.locationID);c.setAttribute("data-location-display-name",d.locationDisplayName);c.innerText=d.locationDisplayName;c.addEventListener("click",e);a.insertAdjacentElement("beforeend",c)}}b=document.getElementById("container--distributorLookup");
window.llm.clearElement(b);b.insertAdjacentElement("beforeend",a)})},onshown:function(a,b){d=b}})},Y=function(a){var d,b=a.currentTarget.closest("td").previousElementSibling,e=function(a){b.getElementsByTagName("input")[0].value=a.currentTarget.getAttribute("data-location-id");b.getElementsByTagName("span")[0].innerText=a.currentTarget.getAttribute("data-location-display-name");d();c()};window.llm.openHtmlModal("licence-manufacturerLookup",{onshow:function(){l(function(){var a=document.createElement("div");
a.className="list is-hoverable";for(var b=0;b<q.length;b+=1){var d=q[b];if(d.locationIsManufacturer){var c=document.createElement("a");c.className="list-item";c.setAttribute("data-location-id",d.locationID);c.setAttribute("data-location-display-name",d.locationDisplayName);c.innerText=d.locationDisplayName;c.addEventListener("click",e);a.insertAdjacentElement("beforeend",c)}}b=document.getElementById("container--manufacturerLookup");window.llm.clearElement(b);b.insertAdjacentElement("beforeend",a)})},
onshown:function(a,b){d=b}})};U=function(a){var d=a.ticketType,b=document.createElement("tr");b.setAttribute("data-ticket-type",d);b.insertAdjacentHTML("beforeend",'<td><input name="ticketType_ticketType" type="hidden" value="'+d+'" /><span>'+d+"</span></td>");d=a.unitCount;b.insertAdjacentHTML("beforeend",'<td class="has-text-right"><input name="ticketType_unitCount" type="hidden" value="'+d+'" /><span>'+d+"</span></td>");var e=a.valuePerDeal,g=(e*d).toFixed(2);b.insertAdjacentHTML("beforeend",'<td class="has-text-right is-nowrap"><span data-tooltip="$'+
e+' value per deal">$ '+g+"</span></td>");e=a.prizesPerDeal;d=(e*d).toFixed(2);b.insertAdjacentHTML("beforeend",'<td class="has-text-right is-nowrap"><input class="is-total-prizes-per-deal" type="hidden" value="'+d+'" /><span data-tooltip="$'+e+' prizes per deal">$ '+d+"</span></td>");b.insertAdjacentHTML("beforeend",'<td><div class="field has-addons"><div class="control"><button class="button is-small is-amend-ticket-type-unit-count-button" data-tooltip="Amend Units" type="button">Amend</button></div><div class="control"><button class="button is-small is-danger is-delete-ticket-type-button" data-tooltip="Delete Ticket Type" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></div></div></td>');
b.getElementsByClassName("is-amend-ticket-type-unit-count-button")[0].addEventListener("click",W);b.getElementsByClassName("is-delete-ticket-type-button")[0].addEventListener("click",V);a=a.licenceFee;b.insertAdjacentHTML("beforeend",'<td class="has-text-right is-nowrap"><input class="is-licence-fee" name="ticketType_licenceFee" type="hidden" value="'+a+'" /><span>$ '+a+"</span></td>");b.insertAdjacentHTML("beforeend",'<td><input name="ticketType_distributorLocationID" type="hidden" value="" /><span><span class="has-text-grey">(Not Set)</span><span></td>');
b.insertAdjacentHTML("beforeend",'<td class="has-text-right"><button class="button is-small is-amend-ticket-type-distributor-button" data-tooltip="Change Distributor" type="button"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="sr-only">Change Distributor</span></button></td>');b.getElementsByClassName("is-amend-ticket-type-distributor-button")[0].addEventListener("click",X);b.insertAdjacentHTML("beforeend",'<td><input name="ticketType_manufacturerLocationID" type="hidden" value="" /><span><span class="has-text-grey">(Not Set)</span><span></td>');
b.insertAdjacentHTML("beforeend",'<td class="has-text-right"><button class="button is-small is-amend-ticket-type-manufacturer-button" data-tooltip="Change Manufacturer" type="button"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="sr-only">Change Manufacturer</span></button></td>');b.getElementsByClassName("is-amend-ticket-type-manufacturer-button")[0].addEventListener("click",Y);p.getElementsByTagName("tbody")[0].insertAdjacentElement("afterbegin",b);E();c();r=!0};E();document.getElementById("is-add-ticket-type-button").addEventListener("click",
function(){var a,d,b,c=function(b){b.preventDefault();U({ticketType:document.getElementById("ticketTypeAdd--ticketType").value,unitCount:document.getElementById("ticketTypeAdd--unitCount").value,valuePerDeal:document.getElementById("ticketTypeAdd--valuePerDeal").value,prizesPerDeal:document.getElementById("ticketTypeAdd--prizesPerDeal").value,licenceFee:document.getElementById("ticketTypeAdd--licenceFee").value});n||h.insertAdjacentHTML("beforeend",'<input class="is-removed-after-save" name="ticketType_toAdd" type="hidden" value="'+
document.getElementById("ticketTypeAdd--ticketType").value+'" />');a()},e=function(){var a=b.value;document.getElementById("ticketTypeAdd--prizesTotal").value=(document.getElementById("ticketTypeAdd--prizesPerDeal").value*a).toFixed(2);document.getElementById("ticketTypeAdd--licenceFee").value=(document.getElementById("ticketTypeAdd--feePerUnit").value*a).toFixed(2)},f=function(){var a=d.selectedOptions[0];document.getElementById("ticketTypeAdd--ticketPrice").value=a.getAttribute("data-ticket-price");
document.getElementById("ticketTypeAdd--ticketCount").value=a.getAttribute("data-ticket-count");document.getElementById("ticketTypeAdd--valuePerDeal").value=(a.getAttribute("data-ticket-price")*a.getAttribute("data-ticket-count")).toFixed(2);document.getElementById("ticketTypeAdd--prizesPerDeal").value=a.getAttribute("data-prizes-per-deal");document.getElementById("ticketTypeAdd--feePerUnit").value=a.getAttribute("data-fee-per-unit");e()},k=function(b){if(b&&0!==b.length){for(var c=0;c<b.length;c+=
1){var e=b[c];if(!p.querySelector("tr[data-ticket-type='"+e.ticketType+"']")){var g=document.createElement("option");g.setAttribute("data-ticket-price",e.ticketPrice.toFixed(2));g.setAttribute("data-ticket-count",e.ticketCount);g.setAttribute("data-prizes-per-deal",e.prizesPerDeal.toFixed(2));g.setAttribute("data-fee-per-unit",(e.feePerUnit||0).toFixed(2));g.value=e.ticketType;g.innerText=e.ticketType;d.insertAdjacentElement("beforeend",g)}}f()}else a(),window.llm.alertModal("No ticket types available",
"","OK","danger")};window.llm.openHtmlModal("licence-ticketTypeAdd",{onshow:function(a){d=document.getElementById("ticketTypeAdd--ticketType");d.addEventListener("change",f);b=document.getElementById("ticketTypeAdd--unitCount");b.addEventListener("change",e);a.getElementsByTagName("form")[0].addEventListener("submit",c)},onshown:function(b,d){a=d;T(k)}})});e=p.getElementsByClassName("is-amend-ticket-type-unit-count-button");for(f=0;f<e.length;f+=1)e[f].addEventListener("click",W);e=p.getElementsByClassName("is-delete-ticket-type-button");
for(f=0;f<e.length;f+=1)e[f].addEventListener("click",V);e=p.getElementsByClassName("is-amend-ticket-type-distributor-button");for(f=0;f<e.length;f+=1)e[f].addEventListener("click",X);e=p.getElementsByClassName("is-amend-ticket-type-manufacturer-button");for(f=0;f<e.length;f+=1)e[f].addEventListener("click",Y)}if(!n){var F=document.getElementById("is-update-expected-licence-fee-button");F&&F.addEventListener("click",function(){var a=document.getElementById("licence--licenceFee");a.value=F.getAttribute("data-licence-fee-expected");
a.classList.remove("is-danger");a.closest(".field").getElementsByClassName("help")[0].remove();F.remove();c();r=!0});document.getElementById("is-add-transaction-button").addEventListener("click",function(){var a,d=function(b){b&&b.preventDefault();window.fetch("/licences/doAddTransaction",{method:"POST",credentials:"include",body:new URLSearchParams(new FormData(a))}).then(function(a){return a.json()}).then(function(a){a.success&&window.location.reload(!0)})};window.llm.openHtmlModal("licence-transactionAdd",
{onshow:function(b){window.llm.getDefaultConfigProperty("externalReceiptNumber_fieldLabel",function(a){b.querySelector("label[for='transactionAdd--externalReceiptNumber']").innerText=a});document.getElementById("transactionAdd--licenceID").value=k;var c=document.getElementById("licence--licenceFee").value,e=document.getElementById("licence--transactionTotal"),e=e?e.innerText:0;document.getElementById("transactionAdd--licenceFee").innerText=c;document.getElementById("transactionAdd--transactionTotal").innerText=
e;c=(c-e).toFixed(2);document.getElementById("transactionAdd--discrepancy").innerText=c;document.getElementById("transactionAdd--transactionAmount").value=c;a=b.getElementsByTagName("form")[0];a.addEventListener("submit",d);Z||(c=document.getElementById("is-add-transaction-issue-licence-button"),c.classList.remove("is-hidden"),c.addEventListener("click",function(){document.getElementById("transactionAdd--issueLicence").value="true";d()}))}})})}n||((e=document.getElementById("is-unissue-licence-button"))?
e.addEventListener("click",function(){window.llm.confirmModal("Unissue Licence?","Are you sure you want to unissue this lottery licence?","Yes, Unissue","danger",function(){window.fetch("/licences/doUnissueLicence",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({licenceID:k})}).then(function(a){return a.json()}).then(function(a){a.success&&window.location.reload(!0)})})}):document.getElementById("is-issue-licence-button").addEventListener("click",
function(){var a=function(){window.fetch("/licences/doIssueLicence",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({licenceID:k})}).then(function(a){return a.json()}).then(function(a){a.success&&window.location.reload(!0)})};G?window.llm.alertModal("Unsaved Changes","Please save all unsaved changes before issuing this licence.","OK","warning"):window.llm.confirmModal("Issue Licence?","Are you sure you want to issue this lottery licence?","Yes, Issue",
"success",a)}))})();
