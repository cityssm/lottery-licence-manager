(function(){function v(){f.classList.remove("has-status-loaded");f.classList.add("has-status-loading");for(var a=f.getElementsByClassName("is-bank-record-container"),b=0;b<a.length;b+=1)a[b].innerHTML='<span class="icon" data-tooltip="No Record Recorded" aria-label="No Record Recorded"><i class="fas fa-minus has-text-grey-lighter" aria-hidden="true"></i></span>',a[b].setAttribute("data-record-index","")}function p(){v();llm.postJSON("/organizations/doGetBankRecords",{organizationID:q,bankingYear:l.value,
accountNumber:h.value},function(a){for(var b=0;b<a.length;b+=1){var c=a[b],d=f.querySelector("[data-banking-month='"+c.bankingMonth+"']").querySelector("[data-bank-record-type='"+c.bankRecordType+"']");d&&(d.setAttribute("data-record-index",c.recordIndex),d.innerHTML=c.recordIsNA?'<span class="icon" data-tooltip="Not Applicable" aria-label="Not Applicable"><i class="fas fa-times has-text-grey" aria-hidden="true"></i></span>':'<span class="icon" data-tooltip="Recorded '+c.recordDateString+'" aria-label="Recorded '+
c.recordDateString+'"><i class="fas fa-check has-text-success" aria-hidden="true"></i></span>')}f.classList.remove("has-status-loading");f.classList.add("has-status-loaded")})}function w(){llm.postJSON("/organizations/doGetBankRecordStats",{organizationID:q},function(a){var b=(new Date).getFullYear(),c=b-1;if(0===a.length)h.innerHTML='<option value="">(No Accounts Recorded)</option>';else{h.innerHTML="";for(var d=0;d<a.length;d+=1){var e=a[d],c=Math.min(e.bankingYearMin,c),f=llm.escapeHTML(e.accountNumber);
h.insertAdjacentHTML("beforeend",'<option value="'+f+'">'+f+" (From "+e.bankingYearMin+" to "+e.bankingYearMax+")</option>")}}l.innerHTML="";for(a=b;a>=c;--a)l.insertAdjacentHTML("beforeend",'<option value="'+a+'">'+a+"</option>");p()})}var d=document.getElementById("container--remarks");if("true"===document.getElementsByTagName("main")[0].getAttribute("data-can-create")){var m=d.getAttribute("data-organization-id"),n,r=function(a){a=a.currentTarget.getAttribute("data-remark-index");llm.organizationRemarks.openEditRemarkModal(m,
a,n)},t=function(a){a=a.currentTarget.getAttribute("data-remark-index");llm.organizationRemarks.deleteRemark(m,a,!0,n)};n=function(){llm.organizationRemarks.getRemarksByOrganizationID(m,function(a){llm.clearElement(d);if(0===a.length)d.innerHTML='<div class="panel-block"><div class="message is-info"><p class="message-body">There are no remarks associated with this organization.</p></div></div>';else{for(var b=0;b<a.length;b+=1){var c=a[b];d.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="columns is-mobile"><div class="column is-narrow">'+
(c.isImportant?'<i class="fas fa-fw fa-star" aria-hidden="true"></i>':'<i class="far fa-fw fa-comment" aria-hidden="true"></i>')+'</div><div class="column"><p class="has-newline-chars">'+llm.escapeHTML(c.remark)+'</p><p class="is-size-7">'+c.recordUpdate_userName+" - "+c.remarkDateString+" "+c.remarkTimeString+"</p></div>"+(c.canUpdate?'<div class="column is-narrow"><div class="buttons is-right has-addons"><button class="button is-small is-edit-remark-button" data-remark-index="'+c.remarkIndex+'" type="button"><span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></button><button class="button is-small has-text-danger is-delete-remark-button" data-remark-index="'+
c.remarkIndex+'" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></div></div>':"")+"</div></div>")}a=d.getElementsByClassName("is-edit-remark-button");for(b=0;b<a.length;b+=1)a[b].addEventListener("click",r);a=d.getElementsByClassName("is-delete-remark-button");for(b=0;b<a.length;b+=1)a[b].addEventListener("click",t)}})};document.getElementsByClassName("is-add-remark-button")[0].addEventListener("click",function(a){a.preventDefault();llm.organizationRemarks.openAddRemarkModal(m,
n)});for(var e=d.getElementsByClassName("is-edit-remark-button"),g=0;g<e.length;g+=1)e[g].addEventListener("click",r);e=d.getElementsByClassName("is-delete-remark-button");for(g=0;g<e.length;g+=1)e[g].addEventListener("click",t)}if(e=document.getElementById("remark--searchStr")){e.value="";var x=document.getElementById("remark--displayCount"),k=d.getElementsByClassName("is-remark-block");e.addEventListener("keyup",function(a){a=a.currentTarget.value.trim().toLowerCase().split(" ");for(var b=k.length,
c=0;c<k.length;c+=1){for(var d=k[c].getElementsByClassName("is-remark")[0].innerText.trim().toLowerCase(),e=!0,f=0;f<a.length;f+=1)if(-1===d.indexOf(a[f])){e=!1;--b;break}e?k[c].classList.remove("is-hidden"):k[c].classList.add("is-hidden")}x.innerText=b})}var u=!1,l=document.getElementById("bankRecordFilter--bankingYear"),h=document.getElementById("bankRecordFilter--accountNumber"),f=document.getElementById("table--bankRecords"),q=f.getAttribute("data-organization-id");l.addEventListener("change",
p);h.addEventListener("change",p);llm.initializeTabs(document.getElementById("tabs--organization"),{onshown:function(a){"organizationTab--bankRecords"!==a.id||u||(u=!0,w())}})})();
