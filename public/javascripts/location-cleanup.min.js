(function(){function n(b){var c=b.currentTarget;b=cityssm.escapeHTML(c.getAttribute("data-location-display-name"));llm.confirmModal("Delete Location?","Are you sure you want delete "+b+"?","Yes, Delete","danger",function(){var b=c.getAttribute("data-location-id");cityssm.postJSON("/locations/doDelete",{locationID:b},function(b){b.success?(llm.alertModal(b.message,"","OK","success"),c.closest("tr").remove()):llm.alertModal(b.message,"","OK","danger")})})}function f(){h.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading locations...</em></p>';
cityssm.postJSON("/locations/doGetInactive",{inactiveYears:g.value},function(b){if(0===b.length)h.innerHTML='<div class="message is-info"><p class="message-body">There are no inactive locations to report.</p></div>';else{var c=document.createElement("table");c.className="table is-fullwidth is-striped is-hoverable";c.innerHTML='<thead><tr><th>Location</th><th class="has-text-centered">Last Licence End Date</th><th class="has-text-centered">Last Updated</th><th><span class="sr-only">Delete</span></th></tr></thead>';
for(var f=document.createElement("tbody"),k=0;k<b.length;k+=1){var a=b[k],e=document.createElement("tr"),g=cityssm.escapeHTML(a.locationDisplayName);e.insertAdjacentHTML("beforeend",'<td><a data-tooltip="View Location" href="/locations/'+a.locationID+'">'+g+"</a>"+(a.locationDisplayName===a.locationAddress1?"":"<br /><small>"+cityssm.escapeHTML(a.locationAddress1)+"</small>")+"</td>");var d=a.licences_endDateMax,l=a.licences_endDateMaxString,m="Licence Location";a.distributor_endDateMax&&(!d||d<a.distributor_endDateMax)&&
(d=a.distributor_endDateMax,l=a.distributor_endDateMaxString,m="Distributor");a.manufacturer_endDateMax&&(!d||d<a.manufacturer_endDateMax)&&(d=a.manufacturer_endDateMax,l=a.manufacturer_endDateMaxString,m="Manufacturer");e.insertAdjacentHTML("beforeend",'<td class="has-text-centered">'+(d?l+'<br /><span class="tag is-light is-info">'+m+"</span>":'<span class="tag is-light is-danger">No Licences</span>')+"</td>");e.insertAdjacentHTML("beforeend",'<td class="has-text-centered"><span data-tooltip="Updated by '+
a.recordUpdate_userName+'">'+a.recordUpdate_dateString+"</span></td>");e.insertAdjacentHTML("beforeend",'<td class="has-text-right"><button class="button is-small is-danger" data-tooltip="Delete Location" data-location-id="'+a.locationID+'" data-location-display-name="'+g+'" type="button"><span class="icon"><i class="fas fa-trash" aria-hidden="true"></i></span> <span>Delete</span></button></td>');e.getElementsByTagName("button")[0].addEventListener("click",n);f.insertAdjacentElement("beforeend",e)}c.insertAdjacentElement("beforeend",
f);cityssm.clearElement(h);h.insertAdjacentElement("beforeend",c)}})}var g=document.getElementById("filter--inactiveYears"),h=document.getElementById("container--searchResults");g.addEventListener("change",f);f()})();
